2022-09-22 14:00:09,799 - CRITICAL - 


<<<<<<<-------------------------------NumOfFeaturesToRecover: 20------------------------------->>>>>>>
2022-09-22 14:00:09,799 - CRITICAL - Running on device: cuda:0
2022-09-22 14:00:09,801 - CRITICAL - Writing log to file: C:\Haider\Research\InferenceAttacksDefenses\featureinference-vfl\GRNA\log\drive-2022-09-22-14-00-09-attacker-28-victim-20-mean-False-type-NN-predict-0.2.log
2022-09-22 14:00:09,801 - CRITICAL - n_attacker = 28, n_victim = 20
2022-09-22 14:00:09,804 - INFO - # By default, section names are case sensitive but keys are not
# Config parsers do not guess datatypes of values in configuration files, always storing them internally as strings. 

[DEFAULT]
DataFile = drive_cleaned.csv
LogFile = drive.log
NumOfFeaturesOwnedByAttacker = 28
NumOfFeaturesToRecover = 20
RunningTimes = 2

[DATASET]
TrainPortion = 0.6
TestPortion = 0.2
PredictPortion = 0.2

[DEFENCE]
EnableConfidenceRounding = False
RoundingPrecision = 1

[GENERATOR]
Epochs = 60
EnableAttackerFeatures = True  
EnableKnownMeanConstraint = False         
KnownMeanLambda = 1.2
UnknownVarLambda = 0.25

# modeltype should be one of (LR, NN, RF)
[CLASSIFIER]
ModeType = NN
# MUST SET: should be 2 for LR 
ClassNum = 11
Epochs = 60      

    

2022-09-22 14:00:09,804 - CRITICAL - 

<----------------- Running count: 1 / 2 ----------------->


2022-09-22 14:00:12,635 - CRITICAL - Dataset column permutation is: 
 tensor([ 7, 31, 27, 47, 24,  2, 36, 25, 11,  9,  5, 12, 21,  3, 23, 38, 42, 45,
        37, 34, 39,  0,  4, 40, 41,  6, 20, 14, 17, 30, 35, 28, 19, 26, 32, 22,
        33, 46, 44, 15,  8, 10, 13, 29, 18,  1, 16, 43])
2022-09-22 14:00:12,650 - CRITICAL - Creating dataset, len(samples): 58509; positive labels sum: 53190
2022-09-22 14:00:12,662 - CRITICAL - For dataset C:\Haider\Research\InferenceAttacksDefenses\featureinference-vfl\datasets\drive_cleaned.csv, dataset length: 58509
2022-09-22 14:00:12,662 - CRITICAL - 
[FUNCTION]: Splitting dataset by getSplittedDataset()......
2022-09-22 14:00:12,663 - INFO - Display first (x, y) pair of dataset:
 tensor([8.1753e-01, 3.6554e-01, 3.9434e-01, 1.1781e-01, 3.5851e-01, 7.2105e-01,
        6.0996e-05, 5.0865e-01, 3.2505e-01, 3.2505e-01, 7.7792e-01, 1.3157e-04,
        6.2360e-02, 8.9780e-01, 6.2405e-02, 2.0749e-02, 4.3299e-01, 1.1835e-01,
        1.5917e-02, 6.3140e-01, 7.3337e-05, 7.0346e-01, 9.1003e-01, 3.9992e-03,
        5.1032e-02, 8.2103e-01, 6.2769e-02, 2.3714e-03, 4.7071e-03, 3.5808e-01,
        6.3767e-01, 5.2852e-01, 6.2719e-02, 4.1320e-01, 3.6990e-01, 6.2368e-02,
        6.2594e-01, 1.2688e-01, 4.0469e-01, 1.1571e-04, 8.1294e-01, 3.2502e-01,
        8.5679e-04, 5.0881e-01, 6.2715e-02, 5.4556e-01, 9.0313e-04, 4.2939e-01]), tensor(0.)
2022-09-22 14:00:12,664 - INFO - Shape of (x, y): torch.Size([48]) torch.Size([])
2022-09-22 14:00:12,667 - CRITICAL - len(trainset): 35105
2022-09-22 14:00:12,672 - CRITICAL - len(testset): 11701
2022-09-22 14:00:12,672 - CRITICAL - len(predictset): 11703
2022-09-22 14:00:12,673 - INFO - len(trainloader): 549
2022-09-22 14:00:12,673 - INFO - len(testloader): 183
2022-09-22 14:00:12,673 - INFO - len(predictloader): 183
2022-09-22 14:00:12,673 - CRITICAL - 
[FUNCTION]: Creating GlobalClassifierTrainer......
2022-09-22 14:00:12,673 - CRITICAL - Creating a model for type NN
2022-09-22 14:00:13,382 - INFO - Structure of Global Classifier: GlobalPreModel_NN(
  (dense): Sequential(
    (0): Linear(in_features=48, out_features=600, bias=True)
    (1): ReLU()
    (2): Linear(in_features=600, out_features=300, bias=True)
    (3): ReLU()
    (4): Linear(in_features=300, out_features=100, bias=True)
    (5): ReLU()
    (6): Linear(in_features=100, out_features=11, bias=True)
  )
)
2022-09-22 14:00:13,382 - CRITICAL - 
[FUNCTION]: Creating GeneratorTrainer......
2022-09-22 14:00:13,383 - CRITICAL - Creating a generator
2022-09-22 14:00:13,389 - INFO - Structure of Generator: Generator(
  (net): Sequential(
    (0): Linear(in_features=48, out_features=600, bias=True)
    (1): LayerNorm((600,), eps=1e-05, elementwise_affine=True)
    (2): ReLU()
    (3): Linear(in_features=600, out_features=200, bias=True)
    (4): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
    (5): ReLU()
    (6): Linear(in_features=200, out_features=100, bias=True)
    (7): LayerNorm((100,), eps=1e-05, elementwise_affine=True)
    (8): ReLU()
    (9): Linear(in_features=100, out_features=20, bias=True)
    (10): Sigmoid()
  )
)
2022-09-22 14:00:13,389 - CRITICAL - 
[FUNCTION]: Training global classifier NN......
2022-09-22 14:00:16,763 - CRITICAL - In epoch 0, train accur is 0.5779518485069275, test accur is 0.8036065101623535.
2022-09-22 14:00:33,138 - CRITICAL - In epoch 12, train accur is 0.924113392829895, test accur is 0.9276130199432373.
2022-09-22 14:00:49,943 - CRITICAL - In epoch 24, train accur is 0.9596353769302368, test accur is 0.9743611216545105.
2022-09-22 14:01:07,169 - CRITICAL - In epoch 36, train accur is 0.9753311276435852, test accur is 0.9730792045593262.
2022-09-22 14:01:24,478 - CRITICAL - In epoch 48, train accur is 0.98353511095047, test accur is 0.9894025921821594.
2022-09-22 14:01:40,074 - CRITICAL - In epoch 59, train accur is 0.9856145977973938, test accur is 0.9891462326049805.
2022-09-22 14:01:40,075 - CRITICAL - 
[FUNCTION]: Training Generator......
2022-09-22 14:01:40,076 - CRITICAL - Enable Attacker Features
2022-09-22 14:01:40,077 - CRITICAL - Disable Mean Constraint
2022-09-22 14:01:40,077 - CRITICAL - parameters['unknownVarLambda'] = 0.25
2022-09-22 14:01:40,077 - CRITICAL - Disable Confidence Rounding
2022-09-22 14:01:40,077 - CRITICAL - parameters['roundPrecision'] = 1
2022-09-22 14:01:41,558 - INFO - >>>>>>>>>>>>>>>>>
2022-09-22 14:01:41,559 - CRITICAL - In epoch 0, loss is tensor(513362.4688, device='cuda:0')
2022-09-22 14:01:41,561 - INFO - L2 norm of yhat: tensor(289.9326, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-22 14:01:41,562 - INFO - L2 norm of original vector: tensor(224.4146, device='cuda:0')
2022-09-22 14:01:41,563 - INFO - First two lines of yhat: tensor([[0.2007, 0.3358, 0.6738, 0.6898, 0.5354, 0.4878, 0.2199, 0.4047, 0.7388,
         0.3850, 0.8046, 0.0908, 0.6090, 0.4706, 0.0970, 0.4786, 0.5638, 0.6043,
         0.1038, 0.7367],
        [0.2626, 0.3581, 0.7161, 0.6466, 0.5695, 0.4733, 0.2921, 0.3792, 0.6718,
         0.3560, 0.7819, 0.0841, 0.6378, 0.3601, 0.0870, 0.5276, 0.5661, 0.6116,
         0.1043, 0.7273]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-22 14:01:41,566 - CRITICAL - Accuracy: tensor(0.9891, device='cuda:0')
2022-09-22 14:02:00,545 - INFO - >>>>>>>>>>>>>>>>>
2022-09-22 14:02:00,547 - CRITICAL - In epoch 12, loss is tensor(23456.5645, device='cuda:0')
2022-09-22 14:02:00,549 - INFO - L2 norm of yhat: tensor(234.1062, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-22 14:02:00,550 - INFO - L2 norm of original vector: tensor(215.2334, device='cuda:0')
2022-09-22 14:02:00,551 - INFO - First two lines of yhat: tensor([[0.0161, 0.5147, 0.6097, 0.7859, 0.3204, 0.5859, 0.2793, 0.4941, 0.6688,
         0.2495, 0.4589, 0.0148, 0.5965, 0.3569, 0.0172, 0.5020, 0.4170, 0.2922,
         0.0152, 0.5798],
        [0.0188, 0.4909, 0.6551, 0.7756, 0.2528, 0.5626, 0.2947, 0.3976, 0.7052,
         0.2615, 0.5419, 0.0120, 0.6263, 0.3397, 0.0161, 0.5204, 0.3125, 0.3619,
         0.0148, 0.6092]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-22 14:02:00,555 - CRITICAL - Accuracy: tensor(0.9891, device='cuda:0')
2022-09-22 14:02:21,126 - INFO - >>>>>>>>>>>>>>>>>
2022-09-22 14:02:21,128 - CRITICAL - In epoch 24, loss is tensor(13265.0527, device='cuda:0')
2022-09-22 14:02:21,130 - INFO - L2 norm of yhat: tensor(233.8852, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-22 14:02:21,131 - INFO - L2 norm of original vector: tensor(215.1741, device='cuda:0')
2022-09-22 14:02:21,132 - INFO - First two lines of yhat: tensor([[0.0213, 0.4137, 0.5324, 0.5445, 0.8103, 0.5115, 0.2856, 0.8710, 0.6049,
         0.2107, 0.3577, 0.0432, 0.6195, 0.3677, 0.0351, 0.6912, 0.8160, 0.2397,
         0.0219, 0.4185],
        [0.0234, 0.3973, 0.6752, 0.4240, 0.7413, 0.6132, 0.3820, 0.7603, 0.5747,
         0.2325, 0.3822, 0.0287, 0.3865, 0.1256, 0.0268, 0.6257, 0.7610, 0.5479,
         0.0249, 0.5412]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-22 14:02:21,135 - CRITICAL - Accuracy: tensor(0.9891, device='cuda:0')
2022-09-22 14:02:40,262 - INFO - >>>>>>>>>>>>>>>>>
2022-09-22 14:02:40,264 - CRITICAL - In epoch 36, loss is tensor(9056.4365, device='cuda:0')
2022-09-22 14:02:40,267 - INFO - L2 norm of yhat: tensor(227.3927, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-22 14:02:40,268 - INFO - L2 norm of original vector: tensor(223.5512, device='cuda:0')
2022-09-22 14:02:40,269 - INFO - First two lines of yhat: tensor([[0.0172, 0.4940, 0.6406, 0.5833, 0.2910, 0.5451, 0.3293, 0.3844, 0.7060,
         0.1997, 0.4913, 0.0152, 0.7072, 0.3895, 0.0203, 0.5769, 0.2945, 0.3744,
         0.0196, 0.4634],
        [0.0090, 0.3573, 0.7063, 0.5972, 0.2428, 0.5539, 0.3042, 0.2359, 0.7526,
         0.1719, 0.6668, 0.0066, 0.6011, 0.3660, 0.0104, 0.5069, 0.2394, 0.5085,
         0.0101, 0.5472]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-22 14:02:40,272 - CRITICAL - Accuracy: tensor(0.9891, device='cuda:0')
2022-09-22 14:02:59,171 - INFO - >>>>>>>>>>>>>>>>>
2022-09-22 14:02:59,173 - CRITICAL - In epoch 48, loss is tensor(7049.2046, device='cuda:0')
2022-09-22 14:02:59,174 - INFO - L2 norm of yhat: tensor(223.2162, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-22 14:02:59,175 - INFO - L2 norm of original vector: tensor(226.2116, device='cuda:0')
2022-09-22 14:02:59,176 - INFO - First two lines of yhat: tensor([[0.0336, 0.4347, 0.5755, 0.5503, 0.8276, 0.4604, 0.3411, 0.8316, 0.6124,
         0.1717, 0.3349, 0.0411, 0.6553, 0.3765, 0.0395, 0.5815, 0.7675, 0.3309,
         0.0269, 0.3688],
        [0.0230, 0.4377, 0.6312, 0.4079, 0.3365, 0.4896, 0.4060, 0.4135, 0.7051,
         0.1632, 0.3637, 0.0154, 0.5178, 0.3489, 0.0206, 0.4807, 0.3009, 0.5378,
         0.0235, 0.3947]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-22 14:02:59,179 - CRITICAL - Accuracy: tensor(0.9891, device='cuda:0')
2022-09-22 14:03:16,618 - INFO - >>>>>>>>>>>>>>>>>
2022-09-22 14:03:16,620 - CRITICAL - In epoch 59, loss is tensor(5500.2842, device='cuda:0')
2022-09-22 14:03:16,623 - INFO - L2 norm of yhat: tensor(220.5668, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-22 14:03:16,625 - INFO - L2 norm of original vector: tensor(225.3895, device='cuda:0')
2022-09-22 14:03:16,626 - INFO - First two lines of yhat: tensor([[0.0261, 0.4166, 0.6217, 0.4132, 0.3651, 0.4538, 0.4174, 0.4057, 0.6858,
         0.1458, 0.3239, 0.0151, 0.5398, 0.3324, 0.0225, 0.5020, 0.2981, 0.5517,
         0.0231, 0.3655],
        [0.0126, 0.3273, 0.6566, 0.4571, 0.5007, 0.4939, 0.3624, 0.4653, 0.6763,
         0.1403, 0.4048, 0.0103, 0.5164, 0.3606, 0.0170, 0.5098, 0.4729, 0.4973,
         0.0100, 0.4277]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-22 14:03:16,631 - CRITICAL - Accuracy: tensor(0.9891, device='cuda:0')
2022-09-22 14:03:16,634 - CRITICAL - 
[FUNCTION]: Testing Generator......
2022-09-22 14:03:16,634 - CRITICAL - Enable Attacker Features
2022-09-22 14:03:16,634 - CRITICAL - Disable Mean Constraint
2022-09-22 14:03:16,731 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-22 14:03:16,732 - CRITICAL - Model output loss: 0.004376289434731007
2022-09-22 14:03:16,734 - CRITICAL - Random guess loss: 0.1635851263999939
2022-09-22 14:03:16,734 - INFO - Model output loss PF: [5.58869913e-04 2.56287097e-03 2.21931422e-03 7.40625756e-03
 1.96842360e-03 7.36214826e-03 2.56964006e-03 2.87748408e-03
 1.64648076e-03 1.37733086e-03 1.07189417e-02 1.59805728e-04
 8.97177495e-03 7.26959726e-04 1.17493153e-04 3.56195075e-03
 6.21701032e-03 2.10817028e-02 3.70804592e-05 5.38424589e-03]
2022-09-22 14:03:16,734 - INFO - Random guess loss PF: [0.3255052  0.10048657 0.0977678  0.08250712 0.15164615 0.08688988
 0.07711659 0.18146831 0.11634295 0.21129414 0.08665901 0.34804106
 0.14342737 0.09143206 0.34924695 0.11037302 0.23641118 0.09167264
 0.27800611 0.10540842]
2022-09-22 14:03:16,735 - INFO - Attack result, first 2 samples: tensor([[0.0242, 0.4349, 0.6141, 0.3918, 0.3068, 0.4438, 0.4369, 0.3565, 0.6625,
         0.1594, 0.3711, 0.0128, 0.5370, 0.3557, 0.0214, 0.5248, 0.2757, 0.5770,
         0.0190, 0.3743],
        [0.0164, 0.3365, 0.6455, 0.4983, 0.5766, 0.5126, 0.3502, 0.5817, 0.6696,
         0.1430, 0.3808, 0.0157, 0.5987, 0.3881, 0.0242, 0.5410, 0.5438, 0.4515,
         0.0139, 0.3984]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-22 14:03:16,740 - INFO - Ground truth, first 2 samples: tensor([[0.0511, 0.4366, 0.6217, 0.5562, 0.3136, 0.4556, 0.4474, 0.3127, 0.6099,
         0.1366, 0.3240, 0.0131, 0.5485, 0.3370, 0.0193, 0.4704, 0.3136, 0.5499,
         0.0158, 0.3424],
        [0.0458, 0.2995, 0.6460, 0.5263, 0.5786, 0.3918, 0.3129, 0.5758, 0.6344,
         0.1102, 0.3871, 0.0164, 0.6466, 0.3878, 0.0225, 0.5327, 0.5786, 0.5518,
         0.0186, 0.4108]], device='cuda:0'):
2022-09-22 14:03:16,754 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-22 14:03:16,754 - CRITICAL - Model output loss: 0.004294465761631727
2022-09-22 14:03:16,754 - CRITICAL - Random guess loss: 0.15574339032173157
2022-09-22 14:03:16,754 - INFO - Model output loss PF: [7.55052315e-04 2.31808051e-03 2.47081695e-03 8.11521709e-03
 2.18767626e-03 6.28682785e-03 1.90956262e-03 3.06876237e-03
 1.72516052e-03 1.41738867e-03 1.16966339e-02 1.34500733e-04
 7.45688612e-03 8.52076744e-04 1.19904849e-04 4.77342308e-03
 5.31968288e-03 1.67495608e-02 3.66725544e-05 8.49542208e-03]
2022-09-22 14:03:16,755 - INFO - Random guess loss PF: [0.32532594 0.08801793 0.11582091 0.07555493 0.16357753 0.10747366
 0.09463207 0.16757359 0.09118349 0.1874094  0.11725209 0.2489306
 0.14549272 0.12637019 0.26183355 0.09521697 0.16459878 0.08216409
 0.3495321  0.10690728]
2022-09-22 14:03:16,755 - INFO - Attack result, first 2 samples: tensor([[0.0306, 0.3989, 0.6022, 0.4413, 0.5255, 0.4350, 0.3746, 0.5999, 0.6610,
         0.1596, 0.3171, 0.0230, 0.4680, 0.3718, 0.0289, 0.5056, 0.4919, 0.5223,
         0.0225, 0.3471],
        [0.0216, 0.3250, 0.6459, 0.5711, 0.8551, 0.5156, 0.3310, 0.8236, 0.6060,
         0.1410, 0.4036, 0.0242, 0.6513, 0.3013, 0.0301, 0.5525, 0.7935, 0.3757,
         0.0154, 0.4298]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-22 14:03:16,760 - INFO - Ground truth, first 2 samples: tensor([[0.0920, 0.3138, 0.6643, 0.5292, 0.5844, 0.4721, 0.3216, 0.5866, 0.6521,
         0.1425, 0.2522, 0.0158, 0.4902, 0.3614, 0.0237, 0.6957, 0.5844, 0.5522,
         0.0190, 0.2810],
        [0.0135, 0.3651, 0.6424, 0.5210, 0.8549, 0.3192, 0.3775, 0.8549, 0.6305,
         0.1237, 0.3402, 0.0061, 0.7397, 0.3140, 0.0137, 0.5206, 0.8549, 0.5451,
         0.0085, 0.3666]], device='cuda:0'):
2022-09-22 14:03:16,774 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-22 14:03:16,774 - CRITICAL - Model output loss: 0.004520338028669357
2022-09-22 14:03:16,784 - CRITICAL - Random guess loss: 0.16035805642604828
2022-09-22 14:03:16,789 - INFO - Model output loss PF: [5.94724144e-04 1.77790294e-03 2.84403260e-03 7.62536330e-03
 2.06745230e-03 8.85151420e-03 2.38205586e-03 3.14684631e-03
 1.94228371e-03 1.87778508e-03 1.40682003e-02 1.25504695e-04
 6.30290061e-03 9.13339725e-04 1.03523809e-04 3.85311153e-03
 5.25243441e-03 1.80336870e-02 3.61989623e-05 8.60790070e-03]
2022-09-22 14:03:16,790 - INFO - Random guess loss PF: [0.30200219 0.11510947 0.12746966 0.07642777 0.15555193 0.09107559
 0.11451706 0.12737884 0.10353355 0.21476084 0.10767699 0.40628052
 0.11517491 0.15200087 0.29918873 0.1005398  0.11860894 0.07533276
 0.32215655 0.08237383]
2022-09-22 14:03:16,790 - INFO - Attack result, first 2 samples: tensor([[0.0220, 0.3399, 0.6283, 0.4289, 0.3805, 0.5062, 0.3983, 0.4231, 0.7061,
         0.1482, 0.3446, 0.0164, 0.5454, 0.3642, 0.0279, 0.5039, 0.3353, 0.5244,
         0.0206, 0.3721],
        [0.0075, 0.3280, 0.7216, 0.6329, 0.1608, 0.5624, 0.3617, 0.0982, 0.6927,
         0.1810, 0.6601, 0.0049, 0.6883, 0.4117, 0.0084, 0.5461, 0.1519, 0.4701,
         0.0057, 0.5280]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-22 14:03:16,797 - INFO - Ground truth, first 2 samples: tensor([[4.0603e-02, 3.4989e-01, 6.4929e-01, 5.4558e-01, 3.9864e-01, 4.6725e-01,
         3.5908e-01, 4.0116e-01, 6.3800e-01, 1.5269e-01, 2.0821e-01, 1.4559e-02,
         5.1626e-01, 3.5181e-01, 2.0237e-02, 6.1353e-01, 3.9868e-01, 5.4985e-01,
         1.7925e-02, 2.3538e-01],
        [2.8386e-03, 3.6153e-01, 6.4212e-01, 4.7366e-01, 5.5855e-02, 3.8012e-01,
         3.7295e-01, 5.6105e-02, 6.3036e-01, 1.4140e-01, 3.7977e-01, 1.8348e-04,
         7.0235e-01, 3.8953e-01, 1.9367e-03, 5.5635e-01, 5.5858e-02, 5.4534e-01,
         1.4050e-03, 4.0371e-01]], device='cuda:0'):
2022-09-22 14:03:16,811 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-22 14:03:16,811 - CRITICAL - Model output loss: 0.004150716587901115
2022-09-22 14:03:16,812 - CRITICAL - Random guess loss: 0.14983978867530823
2022-09-22 14:03:16,812 - INFO - Model output loss PF: [4.17547708e-04 2.87693180e-03 2.80439924e-03 5.34207933e-03
 1.43803470e-03 9.16041061e-03 2.55946536e-03 2.08945572e-03
 1.52159715e-03 1.64973643e-03 1.28175840e-02 7.90677514e-05
 6.06923457e-03 7.23299570e-04 9.73129063e-05 3.39953066e-03
 4.36264463e-03 1.76667869e-02 3.66900749e-05 7.90252350e-03]
2022-09-22 14:03:16,813 - INFO - Random guess loss PF: [0.27970615 0.12445651 0.08696318 0.0913939  0.12798232 0.08159547
 0.10417038 0.11401816 0.1003794  0.20551127 0.11620269 0.30176657
 0.15130512 0.09983981 0.34673578 0.08789743 0.10836344 0.07628299
 0.28930908 0.10291608]
2022-09-22 14:03:16,813 - INFO - Attack result, first 2 samples: tensor([[0.0174, 0.4004, 0.6095, 0.6241, 0.2977, 0.5753, 0.3704, 0.2713, 0.6934,
         0.1909, 0.4853, 0.0169, 0.7713, 0.4912, 0.0253, 0.5986, 0.2559, 0.3626,
         0.0157, 0.4289],
        [0.0143, 0.3753, 0.6781, 0.5519, 0.2754, 0.5531, 0.3885, 0.2447, 0.6579,
         0.1659, 0.4975, 0.0076, 0.7295, 0.3335, 0.0143, 0.5325, 0.2392, 0.4548,
         0.0118, 0.4483]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-22 14:03:16,817 - INFO - Ground truth, first 2 samples: tensor([[0.0291, 0.3247, 0.6808, 0.5329, 0.2830, 0.2835, 0.3405, 0.2796, 0.6684,
         0.1247, 0.3021, 0.0135, 0.8524, 0.5130, 0.0195, 0.4831, 0.2830, 0.5436,
         0.0131, 0.3352],
        [0.0131, 0.3915, 0.6413, 0.5655, 0.2442, 0.5763, 0.3992, 0.2447, 0.6298,
         0.1425, 0.3768, 0.0035, 0.7827, 0.3248, 0.0068, 0.5278, 0.2442, 0.5451,
         0.0054, 0.4051]], device='cuda:0'):
2022-09-22 14:03:16,831 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-22 14:03:16,831 - CRITICAL - Model output loss: 0.004724481608718634
2022-09-22 14:03:16,831 - CRITICAL - Random guess loss: 0.15778140723705292
2022-09-22 14:03:16,831 - INFO - Model output loss PF: [4.31641121e-04 2.15671211e-03 3.05118877e-03 5.43229468e-03
 1.90440810e-03 1.16692502e-02 2.95941392e-03 2.93782307e-03
 1.84933085e-03 1.96310715e-03 1.40179684e-02 1.02731588e-04
 6.53372798e-03 1.07195345e-03 9.13538097e-05 5.45837544e-03
 4.90202941e-03 1.74196679e-02 3.12319753e-05 1.05054229e-02]
2022-09-22 14:03:16,832 - INFO - Random guess loss PF: [0.29612482 0.10485844 0.10629101 0.0769424  0.15104429 0.0865694
 0.09976294 0.16511483 0.0994198  0.16787359 0.10128738 0.28272235
 0.15460509 0.1401895  0.33106208 0.0990842  0.17263684 0.07628669
 0.33099532 0.11275731]
2022-09-22 14:03:16,832 - INFO - Attack result, first 2 samples: tensor([[0.0121, 0.3906, 0.6346, 0.6886, 0.2241, 0.5766, 0.3617, 0.1607, 0.6915,
         0.1949, 0.6099, 0.0114, 0.7761, 0.5414, 0.0177, 0.5983, 0.1972, 0.3655,
         0.0091, 0.4982],
        [0.0091, 0.2499, 0.8104, 0.4777, 0.2536, 0.5210, 0.3585, 0.2221, 0.6598,
         0.2712, 0.6258, 0.0052, 0.2804, 0.1176, 0.0075, 0.4320, 0.3122, 0.7688,
         0.0100, 0.6846]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-22 14:03:16,836 - INFO - Ground truth, first 2 samples: tensor([[1.7908e-02, 4.2182e-01, 6.7437e-01, 5.3223e-01, 1.6885e-01, 4.0611e-01,
         4.3291e-01, 1.7031e-01, 6.6134e-01, 1.4301e-01, 3.5777e-01, 3.0513e-03,
         8.5358e-01, 5.7606e-01, 7.7148e-03, 4.8178e-01, 1.6884e-01, 5.4444e-01,
         5.1000e-03, 3.8516e-01],
        [2.0698e-03, 1.9557e-01, 6.4824e-01, 5.3310e-01, 1.3485e-01, 4.4291e-01,
         2.1021e-01, 1.3575e-01, 6.3631e-01, 1.3925e-01, 4.6188e-01, 3.3788e-04,
         1.6827e-01, 1.0382e-02, 1.0379e-03, 5.5472e-01, 1.3484e-01, 5.4465e-01,
         2.9237e-04, 4.8502e-01]], device='cuda:0'):
2022-09-22 14:03:16,851 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-22 14:03:16,853 - CRITICAL - Model output loss: 0.0036960297729820013
2022-09-22 14:03:16,853 - CRITICAL - Random guess loss: 0.15723828971385956
2022-09-22 14:03:16,854 - INFO - Model output loss PF: [8.67498107e-04 2.57271575e-03 1.94939261e-03 5.17980754e-03
 1.62520504e-03 6.74670003e-03 2.37423740e-03 2.88787787e-03
 1.96983246e-03 1.78852258e-03 9.39869881e-03 1.17032199e-04
 5.47475368e-03 8.00994108e-04 8.89109870e-05 2.81482493e-03
 5.26049500e-03 1.62687711e-02 3.21045445e-05 5.70221245e-03]
2022-09-22 14:03:16,854 - INFO - Random guess loss PF: [0.34307489 0.09572237 0.12185876 0.10309483 0.15026259 0.07534242
 0.09100585 0.13422915 0.10407009 0.19071397 0.13475749 0.31336796
 0.1225333  0.13833775 0.28968394 0.09394505 0.12450795 0.09497474
 0.33619982 0.08708277]
2022-09-22 14:03:16,854 - INFO - Attack result, first 2 samples: tensor([[0.0323, 0.3481, 0.6180, 0.5451, 0.8739, 0.4728, 0.3406, 0.8553, 0.6126,
         0.1520, 0.3487, 0.0395, 0.5721, 0.3337, 0.0432, 0.5536, 0.8103, 0.3815,
         0.0216, 0.3659],
        [0.0227, 0.3549, 0.6276, 0.4779, 0.5748, 0.4816, 0.3537, 0.6034, 0.6773,
         0.1462, 0.3429, 0.0203, 0.5817, 0.3922, 0.0312, 0.5325, 0.5014, 0.4361,
         0.0181, 0.3663]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-22 14:03:16,860 - INFO - Ground truth, first 2 samples: tensor([[0.0509, 0.3233, 0.6676, 0.5211, 0.9177, 0.4021, 0.3394, 0.9224, 0.6556,
         0.1608, 0.3123, 0.0199, 0.6707, 0.3698, 0.0321, 0.5839, 0.9178, 0.5443,
         0.0260, 0.3409],
        [0.0375, 0.3209, 0.6682, 0.5347, 0.5799, 0.4917, 0.3344, 0.5777, 0.6567,
         0.1452, 0.3079, 0.0161, 0.6298, 0.4020, 0.0249, 0.5441, 0.5800, 0.5455,
         0.0172, 0.3395]], device='cuda:0'):
2022-09-22 14:03:16,873 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-22 14:03:16,874 - CRITICAL - Model output loss: 0.004075293894857168
2022-09-22 14:03:16,874 - CRITICAL - Random guess loss: 0.15829434990882874
2022-09-22 14:03:16,874 - INFO - Model output loss PF: [5.51867299e-04 2.51336629e-03 1.72094489e-03 7.82985240e-03
 1.75564678e-03 8.15856550e-03 2.31104949e-03 2.44961539e-03
 1.76426338e-03 1.15545280e-03 1.32337641e-02 9.35520729e-05
 6.23452105e-03 4.39970958e-04 1.07145286e-04 3.66950501e-03
 4.15628869e-03 1.73795819e-02 4.69272345e-05 5.93399163e-03]
2022-09-22 14:03:16,875 - INFO - Random guess loss PF: [0.31967905 0.09336571 0.10289347 0.08470602 0.12902912 0.08193475
 0.07533206 0.13740748 0.08837673 0.24757798 0.0942532  0.33381373
 0.12990192 0.10806926 0.33502525 0.08439457 0.13082175 0.09741315
 0.34085643 0.15103558]
2022-09-22 14:03:16,875 - INFO - Attack result, first 2 samples: tensor([[0.0146, 0.3620, 0.6187, 0.5194, 0.5360, 0.5035, 0.3594, 0.5026, 0.6837,
         0.1595, 0.4125, 0.0148, 0.6611, 0.4434, 0.0239, 0.5508, 0.4955, 0.4148,
         0.0132, 0.4118],
        [0.0109, 0.3477, 0.6617, 0.5906, 0.2664, 0.5505, 0.3670, 0.2192, 0.6968,
         0.1747, 0.5255, 0.0090, 0.7062, 0.4176, 0.0146, 0.5782, 0.2555, 0.4242,
         0.0097, 0.4698]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-22 14:03:16,879 - INFO - Ground truth, first 2 samples: tensor([[0.0163, 0.3987, 0.6532, 0.5135, 0.5280, 0.4307, 0.4098, 0.5285, 0.6411,
         0.1328, 0.3108, 0.0046, 0.7378, 0.4564, 0.0168, 0.5194, 0.5280, 0.5448,
         0.0067, 0.3381],
        [0.0128, 0.3759, 0.6526, 0.5385, 0.2446, 0.4381, 0.3872, 0.2427, 0.6404,
         0.1414, 0.3636, 0.0033, 0.7632, 0.4213, 0.0061, 0.4818, 0.2446, 0.5429,
         0.0049, 0.3894]], device='cuda:0'):
2022-09-22 14:03:16,890 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-22 14:03:16,890 - CRITICAL - Model output loss: 0.004556618165224791
2022-09-22 14:03:16,890 - CRITICAL - Random guess loss: 0.16691887378692627
2022-09-22 14:03:16,890 - INFO - Model output loss PF: [5.39696659e-04 1.82805653e-03 2.69338256e-03 8.35252926e-03
 2.11683521e-03 8.23217258e-03 2.11985968e-03 3.07806116e-03
 1.82571413e-03 1.77327567e-03 1.47103481e-02 1.03340950e-04
 6.89924834e-03 9.34001873e-04 1.03498474e-04 2.77731242e-03
 5.23369154e-03 1.83332637e-02 3.13921664e-05 9.44667775e-03]
2022-09-22 14:03:16,891 - INFO - Random guess loss PF: [0.28527945 0.11917727 0.12335286 0.09961466 0.17581987 0.09295121
 0.11253747 0.18873918 0.10673799 0.20707844 0.11530925 0.34735116
 0.13947307 0.13236761 0.31283066 0.09868287 0.14013217 0.10196154
 0.33977377 0.09920698]
2022-09-22 14:03:16,891 - INFO - Attack result, first 2 samples: tensor([[0.0191, 0.3635, 0.6360, 0.5296, 0.7451, 0.4891, 0.3630, 0.7185, 0.6385,
         0.1443, 0.3826, 0.0188, 0.5970, 0.3785, 0.0257, 0.5303, 0.6927, 0.4125,
         0.0132, 0.3977],
        [0.0262, 0.3783, 0.6494, 0.3226, 0.3708, 0.3993, 0.4318, 0.4262, 0.6274,
         0.2148, 0.4356, 0.0129, 0.2177, 0.1712, 0.0152, 0.4539, 0.3715, 0.7449,
         0.0214, 0.5184]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-22 14:03:16,894 - INFO - Ground truth, first 2 samples: tensor([[0.0185, 0.3747, 0.6433, 0.5300, 0.7496, 0.4373, 0.3849, 0.7507, 0.6315,
         0.1355, 0.3314, 0.0057, 0.6837, 0.3888, 0.0100, 0.5530, 0.7495, 0.5448,
         0.0097, 0.3581],
        [0.0296, 0.4300, 0.5884, 0.5322, 0.3585, 0.4201, 0.4411, 0.3634, 0.5776,
         0.1328, 0.3328, 0.0140, 0.0398, 0.1275, 0.0210, 0.5606, 0.3585, 0.5384,
         0.0148, 0.3552]], device='cuda:0'):
2022-09-22 14:03:16,905 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-22 14:03:16,905 - CRITICAL - Model output loss: 0.0039209420792758465
2022-09-22 14:03:16,905 - CRITICAL - Random guess loss: 0.15472131967544556
2022-09-22 14:03:16,905 - INFO - Model output loss PF: [7.57677539e-04 1.51604251e-03 1.93823467e-03 5.72705688e-03
 1.54356554e-03 9.41102020e-03 1.84094440e-03 2.57575302e-03
 1.67470356e-03 1.32497679e-03 1.35042397e-02 1.06197796e-04
 6.09760545e-03 5.00063470e-04 8.13415681e-05 2.91699078e-03
 4.10177279e-03 1.63371079e-02 2.43264767e-05 6.43921923e-03]
2022-09-22 14:03:16,906 - INFO - Random guess loss PF: [0.24771076 0.08435071 0.09638646 0.09505752 0.1704028  0.1105777
 0.10878831 0.15604699 0.10579024 0.18644774 0.1132753  0.29739115
 0.11511467 0.12692097 0.35424    0.10009645 0.15380375 0.0777984
 0.29936427 0.09486215]
2022-09-22 14:03:16,906 - INFO - Attack result, first 2 samples: tensor([[0.0196, 0.3762, 0.6060, 0.5861, 0.8243, 0.4887, 0.3602, 0.7928, 0.6188,
         0.1477, 0.4167, 0.0238, 0.6582, 0.4062, 0.0282, 0.5358, 0.7843, 0.3551,
         0.0140, 0.3943],
        [0.0171, 0.3358, 0.6418, 0.4819, 0.4525, 0.5349, 0.3578, 0.4582, 0.6816,
         0.1496, 0.3803, 0.0135, 0.6498, 0.3565, 0.0236, 0.5394, 0.4061, 0.4747,
         0.0161, 0.4003]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-22 14:03:16,909 - INFO - Ground truth, first 2 samples: tensor([[0.0219, 0.4239, 0.6418, 0.5114, 0.8529, 0.5129, 0.4332, 0.8522, 0.6300,
         0.1452, 0.3299, 0.0064, 0.7936, 0.4265, 0.0126, 0.5412, 0.8529, 0.5443,
         0.0108, 0.3566],
        [0.0548, 0.2946, 0.6220, 0.5345, 0.4483, 0.4704, 0.3083, 0.4485, 0.6111,
         0.1366, 0.3387, 0.0151, 0.6743, 0.3462, 0.0206, 0.5617, 0.4483, 0.5432,
         0.0159, 0.3609]], device='cuda:0'):
2022-09-22 14:03:16,920 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-22 14:03:16,920 - CRITICAL - Model output loss: 0.0037409502547234297
2022-09-22 14:03:16,920 - CRITICAL - Random guess loss: 0.16337226331233978
2022-09-22 14:03:16,920 - INFO - Model output loss PF: [9.32056282e-04 1.60385820e-03 2.22622650e-03 4.75843437e-03
 2.26344191e-03 7.77118187e-03 2.24312022e-03 2.79922364e-03
 1.66947197e-03 1.39532704e-03 1.17390659e-02 1.55700051e-04
 4.94900439e-03 7.18354189e-04 1.15753224e-04 2.79066199e-03
 5.89320250e-03 1.50657231e-02 3.02561020e-05 5.69894584e-03]
2022-09-22 14:03:16,921 - INFO - Random guess loss PF: [0.28874311 0.13877758 0.0960716  0.07974672 0.15833366 0.08727176
 0.09702355 0.17363143 0.10121539 0.18780163 0.14373554 0.34348869
 0.11356992 0.12610102 0.31946602 0.09293003 0.18644449 0.09950909
 0.33789694 0.09568678]
2022-09-22 14:03:16,921 - INFO - Attack result, first 2 samples: tensor([[0.0170, 0.3854, 0.6488, 0.5029, 0.3587, 0.5262, 0.3919, 0.3507, 0.6821,
         0.1573, 0.4033, 0.0123, 0.6833, 0.3667, 0.0199, 0.5361, 0.3117, 0.4487,
         0.0157, 0.4063],
        [0.0362, 0.4207, 0.6021, 0.4987, 0.6631, 0.4582, 0.4086, 0.6745, 0.6332,
         0.1556, 0.3048, 0.0254, 0.6586, 0.3197, 0.0313, 0.5387, 0.5558, 0.4126,
         0.0244, 0.3661]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-22 14:03:16,924 - INFO - Ground truth, first 2 samples: tensor([[0.0437, 0.3241, 0.6304, 0.5589, 0.3489, 0.4719, 0.3360, 0.3497, 0.6189,
         0.1242, 0.3475, 0.0137, 0.7174, 0.3528, 0.0211, 0.5704, 0.3489, 0.5420,
         0.0168, 0.3752],
        [0.0363, 0.4362, 0.6269, 0.5362, 0.6780, 0.5098, 0.4464, 0.6817, 0.6151,
         0.1747, 0.3167, 0.0170, 0.7380, 0.3278, 0.0268, 0.5508, 0.6780, 0.5390,
         0.0204, 0.3338]], device='cuda:0'):
2022-09-22 14:03:18,503 - CRITICAL - ------------------ SUMMARY ------------------
2022-09-22 14:03:18,503 - CRITICAL - Mean generator loss: 0.004115250184266864
2022-09-22 14:03:18,512 - CRITICAL - Mean random guess loss: 0.15823965898302736
2022-09-22 14:03:18,512 - CRITICAL - Mean generator loss Per Feature: [6.48837251e-04 2.02927992e-03 2.36395382e-03 6.63866811e-03
 1.83669872e-03 7.27576949e-03 2.17705807e-03 2.46066032e-03
 1.69854194e-03 1.54313101e-03 1.25617802e-02 1.19234098e-04
 6.34998614e-03 7.51296933e-04 1.24561176e-04 3.48986154e-03
 5.10581297e-03 1.74478796e-02 4.05476281e-05 7.64144337e-03]
2022-09-22 14:03:18,513 - CRITICAL - Mean random guess loss Per Feature: [0.30353834 0.10601038 0.10409242 0.08635506 0.14745743 0.08825514
 0.10004062 0.14855355 0.10093726 0.21472659 0.11457331 0.32685909
 0.14362341 0.11636583 0.316699   0.08787379 0.14558966 0.08625694
 0.32111604 0.10586924]
2022-09-22 14:03:18,514 - CRITICAL - Accuracy: tensor(0.0514, device='cuda:0')
2022-09-22 14:03:18,517 - CRITICAL - Accur: tensor(601., device='cuda:0')
2022-09-22 14:03:18,519 - CRITICAL - Accur: 11703.0
2022-09-22 14:03:18,519 - CRITICAL - 3m 8s (- 3m 8s) (50%)
2022-09-22 14:03:18,519 - CRITICAL - 

<----------------- Running count: 2 / 2 ----------------->


2022-09-22 14:03:21,760 - CRITICAL - Dataset column permutation is: 
 tensor([25, 43, 37, 36, 20, 19, 44, 40,  9, 14, 16,  4, 46,  8, 27,  0, 18,  6,
        13,  2, 28, 41,  7, 10, 12, 30, 22, 11, 47, 35, 15, 32, 23, 39, 17, 34,
        45,  5, 24, 26, 38, 29, 21, 42, 33, 31,  3,  1])
2022-09-22 14:03:21,774 - CRITICAL - Creating dataset, len(samples): 58509; positive labels sum: 53190
2022-09-22 14:03:21,790 - CRITICAL - For dataset C:\Haider\Research\InferenceAttacksDefenses\featureinference-vfl\datasets\drive_cleaned.csv, dataset length: 58509
2022-09-22 14:03:21,790 - CRITICAL - 
[FUNCTION]: Splitting dataset by getSplittedDataset()......
2022-09-22 14:03:21,791 - INFO - Display first (x, y) pair of dataset:
 tensor([5.0865e-01, 4.2939e-01, 1.5917e-02, 6.0996e-05, 6.2769e-02, 6.2719e-02,
        4.0469e-01, 3.9992e-03, 3.2505e-01, 2.3714e-03, 9.0313e-04, 9.1003e-01,
        1.2688e-01, 8.1294e-01, 3.9434e-01, 7.0346e-01, 6.2715e-02, 8.2103e-01,
        8.5679e-04, 7.2105e-01, 5.2852e-01, 5.1032e-02, 8.1753e-01, 3.2502e-01,
        1.3157e-04, 3.5808e-01, 6.2368e-02, 3.2505e-01, 1.1781e-01, 6.3767e-01,
        1.1571e-04, 3.6990e-01, 6.2405e-02, 7.3337e-05, 4.7071e-03, 6.3140e-01,
        1.1835e-01, 7.7792e-01, 3.5851e-01, 4.1320e-01, 2.0749e-02, 5.0881e-01,
        6.2360e-02, 4.3299e-01, 6.2594e-01, 3.6554e-01, 8.9780e-01, 5.4556e-01]), tensor(0.)
2022-09-22 14:03:21,792 - INFO - Shape of (x, y): torch.Size([48]) torch.Size([])
2022-09-22 14:03:21,795 - CRITICAL - len(trainset): 35105
2022-09-22 14:03:21,797 - CRITICAL - len(testset): 11701
2022-09-22 14:03:21,797 - CRITICAL - len(predictset): 11703
2022-09-22 14:03:21,800 - INFO - len(trainloader): 549
2022-09-22 14:03:21,800 - INFO - len(testloader): 183
2022-09-22 14:03:21,800 - INFO - len(predictloader): 183
2022-09-22 14:03:21,800 - CRITICAL - 
[FUNCTION]: Creating GlobalClassifierTrainer......
2022-09-22 14:03:21,801 - CRITICAL - Creating a model for type NN
2022-09-22 14:03:21,804 - INFO - Structure of Global Classifier: GlobalPreModel_NN(
  (dense): Sequential(
    (0): Linear(in_features=48, out_features=600, bias=True)
    (1): ReLU()
    (2): Linear(in_features=600, out_features=300, bias=True)
    (3): ReLU()
    (4): Linear(in_features=300, out_features=100, bias=True)
    (5): ReLU()
    (6): Linear(in_features=100, out_features=11, bias=True)
  )
)
2022-09-22 14:03:21,805 - CRITICAL - 
[FUNCTION]: Creating GeneratorTrainer......
2022-09-22 14:03:21,805 - CRITICAL - Creating a generator
2022-09-22 14:03:21,810 - INFO - Structure of Generator: Generator(
  (net): Sequential(
    (0): Linear(in_features=48, out_features=600, bias=True)
    (1): LayerNorm((600,), eps=1e-05, elementwise_affine=True)
    (2): ReLU()
    (3): Linear(in_features=600, out_features=200, bias=True)
    (4): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
    (5): ReLU()
    (6): Linear(in_features=200, out_features=100, bias=True)
    (7): LayerNorm((100,), eps=1e-05, elementwise_affine=True)
    (8): ReLU()
    (9): Linear(in_features=100, out_features=20, bias=True)
    (10): Sigmoid()
  )
)
2022-09-22 14:03:21,811 - CRITICAL - 
[FUNCTION]: Training global classifier NN......
2022-09-22 14:03:23,576 - CRITICAL - In epoch 0, train accur is 0.5586668848991394, test accur is 0.7710452079772949.
