2022-09-29 21:32:37,847 - CRITICAL - 


<<<<<<<-------------------------------NumOfFeaturesToRecover: 29------------------------------->>>>>>>
2022-09-29 21:32:37,847 - CRITICAL - Running on device: cuda:0
2022-09-29 21:32:37,849 - CRITICAL - Writing log to file: C:\Haider\Research\InferenceAttacksDefenses\featureinference-vfl\GRNA\log\news-2022-09-29-21-32-37-attacker-30-victim-29-mean-False-type-RF-predict-0.2.log
2022-09-29 21:32:37,850 - CRITICAL - n_attacker = 30, n_victim = 29
2022-09-29 21:32:37,852 - INFO - # By default, section names are case sensitive but keys are not
# Config parsers do not guess datatypes of values in configuration files, always storing them internally as strings. 

[DEFAULT]
DataFile = news_cleaned.csv
LogFile = news.log
NumOfFeaturesOwnedByAttacker = 30
NumOfFeaturesToRecover = 29
RunningTimes = 2

[DATASET]
TrainPortion = 0.6
TestPortion = 0.2
PredictPortion = 0.2

[DEFENCE]
EnableConfidenceRounding = False
RoundingPrecision = 1

[GENERATOR]
Epochs = 60
EnableAttackerFeatures = True  
EnableKnownMeanConstraint = False         
KnownMeanLambda = 1.2
UnknownVarLambda = 0.25

# modeltype should be one of (LR, NN, RF)
[CLASSIFIER]
ModeType = RF
# MUST SET: should be 2 for LR 
ClassNum = 5
Epochs = 60      

    

2022-09-29 21:32:37,852 - CRITICAL - 

<----------------- Running count: 1 / 2 ----------------->


2022-09-29 21:32:39,996 - CRITICAL - Dataset column permutation is: 
 tensor([47,  1, 29,  3, 24, 18, 28, 14, 33, 11, 57,  5, 13,  6, 21, 49, 10,  8,
        48, 20, 39, 26, 56,  0, 15,  2, 12,  7, 30, 25, 19, 43, 52, 16,  4, 17,
        45, 46, 44, 58, 23, 32, 55, 41, 42, 35, 38, 22, 51, 50, 40, 34, 36, 37,
        53, 31, 27,  9, 54])
2022-09-29 21:32:40,009 - CRITICAL - Creating dataset, len(samples): 39644; positive labels sum: 34720
2022-09-29 21:32:40,024 - CRITICAL - For dataset C:\Haider\Research\InferenceAttacksDefenses\featureinference-vfl\datasets\news_cleaned.csv, dataset length: 39644
2022-09-29 21:32:40,024 - CRITICAL - 
[FUNCTION]: Splitting dataset by getSplittedDataset()......
2022-09-29 21:32:40,025 - INFO - Display first (x, y) pair of dataset:
 tensor([7.6923e-01, 4.7619e-01, 5.8817e-04, 9.4664e-04, 2.7670e-04, 2.6455e-03,
        5.8817e-04, 0.0000e+00, 0.0000e+00, 4.4444e-01, 0.0000e+00, 1.2544e-03,
        1.0000e+00, 1.3158e-02, 0.0000e+00, 3.7864e-01, 5.8202e-01, 7.8125e-03,
        2.3077e-01, 2.3349e-05, 4.0853e-01, 0.0000e+00, 4.0625e-01, 1.0000e+00,
        0.0000e+00, 2.5844e-02, 0.0000e+00, 1.7241e-02, 1.0000e+00, 0.0000e+00,
        0.0000e+00, 5.2162e-01, 6.5000e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
        2.9367e-01, 7.4074e-02, 4.3359e-01, 1.8750e-01, 0.0000e+00, 0.0000e+00,
        5.0000e-01, 4.4534e-02, 4.3273e-02, 0.0000e+00, 5.3973e-01, 0.0000e+00,
        7.0000e-01, 1.0000e-01, 4.3483e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
        4.0000e-01, 0.0000e+00, 5.8817e-04, 0.0000e+00, 8.0000e-01]), tensor(0.)
2022-09-29 21:32:40,027 - INFO - Shape of (x, y): torch.Size([59]) torch.Size([])
2022-09-29 21:32:40,030 - CRITICAL - len(trainset): 23786
2022-09-29 21:32:40,031 - CRITICAL - len(testset): 7928
2022-09-29 21:32:40,032 - CRITICAL - len(predictset): 7930
2022-09-29 21:32:40,033 - INFO - len(trainloader): 372
2022-09-29 21:32:40,033 - INFO - len(testloader): 124
2022-09-29 21:32:40,033 - INFO - len(predictloader): 124
2022-09-29 21:32:40,033 - CRITICAL - 
[FUNCTION]: Creating GlobalClassifierTrainer......
2022-09-29 21:32:40,033 - CRITICAL - Creating a model for type RF
2022-09-29 21:32:40,033 - CRITICAL - Creating RandomForest, with n_estimators=100, max_depth=3
2022-09-29 21:32:40,732 - INFO - Structure of Fake Random Forest: FakeRandomForest(
  (dense): Sequential(
    (0): Linear(in_features=59, out_features=2000, bias=True)
    (1): Dropout(p=0.5, inplace=False)
    (2): ReLU()
    (3): Linear(in_features=2000, out_features=200, bias=True)
    (4): Dropout(p=0.5, inplace=False)
    (5): ReLU()
    (6): Linear(in_features=200, out_features=5, bias=True)
    (7): Sigmoid()
  )
)
2022-09-29 21:32:40,733 - INFO - Structure of Global Classifier: RandomForestClassifier(max_depth=3, random_state=0)
2022-09-29 21:32:40,734 - CRITICAL - 
[FUNCTION]: Creating GeneratorTrainer......
2022-09-29 21:32:40,734 - CRITICAL - Creating a generator
2022-09-29 21:32:40,739 - INFO - Structure of Generator: Generator(
  (net): Sequential(
    (0): Linear(in_features=59, out_features=600, bias=True)
    (1): LayerNorm((600,), eps=1e-05, elementwise_affine=True)
    (2): ReLU()
    (3): Linear(in_features=600, out_features=200, bias=True)
    (4): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
    (5): ReLU()
    (6): Linear(in_features=200, out_features=100, bias=True)
    (7): LayerNorm((100,), eps=1e-05, elementwise_affine=True)
    (8): ReLU()
    (9): Linear(in_features=100, out_features=29, bias=True)
    (10): Sigmoid()
  )
)
2022-09-29 21:32:40,739 - CRITICAL - 
[FUNCTION]: Training global classifier RF......
2022-09-29 21:32:42,845 - CRITICAL - After training Random Forest, train accur is 0.42075170268225004, test accur is 0.42318365287588294.
2022-09-29 21:32:45,660 - CRITICAL - Creating FakeDataset (torch.Size([396440, 59]), torch.Size([396440, 5]))
2022-09-29 21:32:45,662 - CRITICAL - 
[FUNCTION]: Imitating Random Forest......
2022-09-29 21:32:58,620 - CRITICAL - In epoch 0, train loss is 0.0002440179232507944, test loss is 0.00010129545989912003.
2022-09-29 21:33:09,477 - CRITICAL - In epoch 1, train loss is 6.31028669886291e-05, test loss is 5.959005284239538e-05.
2022-09-29 21:33:20,753 - CRITICAL - In epoch 2, train loss is 5.876704381080344e-05, test loss is 4.8908703320194036e-05.
2022-09-29 21:33:32,286 - CRITICAL - In epoch 3, train loss is 8.050726319197565e-05, test loss is 4.8480371333425865e-05.
2022-09-29 21:33:44,288 - CRITICAL - In epoch 4, train loss is 5.572558075073175e-05, test loss is 4.447110040928237e-05.
2022-09-29 21:33:44,291 - CRITICAL - 
[FUNCTION]: Training Generator......
2022-09-29 21:33:44,291 - CRITICAL - Enable Attacker Features
2022-09-29 21:33:44,292 - CRITICAL - Disable Mean Constraint
2022-09-29 21:33:44,292 - CRITICAL - parameters['unknownVarLambda'] = 0.25
2022-09-29 21:33:44,292 - CRITICAL - Disable Confidence Rounding
2022-09-29 21:33:44,292 - CRITICAL - parameters['roundPrecision'] = 1
2022-09-29 21:33:45,384 - INFO - >>>>>>>>>>>>>>>>>
2022-09-29 21:33:45,385 - CRITICAL - In epoch 0, loss is tensor(0.1053, device='cuda:0')
2022-09-29 21:33:45,387 - INFO - L2 norm of yhat: tensor(366.9987, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-29 21:33:45,388 - INFO - L2 norm of original vector: tensor(346.9298, device='cuda:0')
2022-09-29 21:33:45,389 - INFO - First two lines of yhat: tensor([[0.2900, 0.4267, 0.5632, 0.3676, 0.5655, 0.2664, 0.3627, 0.4116, 0.4666,
         0.7630, 0.5776, 0.4144, 0.2456, 0.5499, 0.4411, 0.2484, 0.3943, 0.4367,
         0.5075, 0.2885, 0.4677, 0.5578, 0.5164, 0.2102, 0.5908, 0.5487, 0.6058,
         0.4729, 0.4149],
        [0.3114, 0.4087, 0.5263, 0.3671, 0.5823, 0.3111, 0.3521, 0.3922, 0.4791,
         0.7655, 0.5597, 0.4138, 0.2630, 0.5434, 0.4777, 0.2475, 0.3894, 0.4057,
         0.5332, 0.2838, 0.5003, 0.5759, 0.5399, 0.1937, 0.6216, 0.5734, 0.5553,
         0.4827, 0.4124]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:33:45,392 - CRITICAL - Accuracy of the original model: tensor(0.4169, device='cuda:0')
2022-09-29 21:33:58,866 - INFO - >>>>>>>>>>>>>>>>>
2022-09-29 21:33:58,867 - CRITICAL - In epoch 12, loss is tensor(0.0790, device='cuda:0')
2022-09-29 21:33:58,869 - INFO - L2 norm of yhat: tensor(385.2305, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-29 21:33:58,870 - INFO - L2 norm of original vector: tensor(348.9215, device='cuda:0')
2022-09-29 21:33:58,871 - INFO - First two lines of yhat: tensor([[0.0681, 0.2106, 0.8305, 0.4584, 0.3647, 0.1237, 0.2025, 0.2110, 0.7678,
         0.8408, 0.7625, 0.0866, 0.2767, 0.2762, 0.1237, 0.1410, 0.0938, 0.0416,
         0.2520, 0.1071, 0.2556, 0.9030, 0.4518, 0.3196, 0.8677, 0.6544, 0.3262,
         0.7838, 0.4400],
        [0.0772, 0.1679, 0.8519, 0.4450, 0.3773, 0.2042, 0.1718, 0.1887, 0.7488,
         0.8531, 0.7744, 0.0817, 0.2969, 0.1719, 0.1078, 0.0824, 0.0797, 0.0341,
         0.2408, 0.1030, 0.4460, 0.9081, 0.4490, 0.2035, 0.8765, 0.6564, 0.3400,
         0.7867, 0.4454]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:33:58,875 - CRITICAL - Accuracy of the original model: tensor(0.4169, device='cuda:0')
2022-09-29 21:34:13,367 - INFO - >>>>>>>>>>>>>>>>>
2022-09-29 21:34:13,368 - CRITICAL - In epoch 24, loss is tensor(0.0744, device='cuda:0')
2022-09-29 21:34:13,370 - INFO - L2 norm of yhat: tensor(354.2941, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-29 21:34:13,372 - INFO - L2 norm of original vector: tensor(341.8746, device='cuda:0')
2022-09-29 21:34:13,373 - INFO - First two lines of yhat: tensor([[0.0250, 0.0897, 0.8084, 0.3757, 0.1843, 0.1798, 0.0665, 0.0454, 0.8892,
         0.8146, 0.3576, 0.0166, 0.1096, 0.1710, 0.0566, 0.0531, 0.0411, 0.0108,
         0.1005, 0.0627, 0.4618, 0.9742, 0.5376, 0.2127, 0.7033, 0.7991, 0.3261,
         0.7690, 0.5225],
        [0.0260, 0.0922, 0.8197, 0.3888, 0.1832, 0.1764, 0.0645, 0.0460, 0.8937,
         0.8107, 0.3722, 0.0171, 0.1126, 0.1849, 0.0490, 0.0536, 0.0453, 0.0101,
         0.0969, 0.0622, 0.4513, 0.9725, 0.5345, 0.2155, 0.6926, 0.8009, 0.3225,
         0.7793, 0.5171]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:34:13,377 - CRITICAL - Accuracy of the original model: tensor(0.4169, device='cuda:0')
2022-09-29 21:34:28,905 - INFO - >>>>>>>>>>>>>>>>>
2022-09-29 21:34:28,906 - CRITICAL - In epoch 36, loss is tensor(0.0718, device='cuda:0')
2022-09-29 21:34:28,909 - INFO - L2 norm of yhat: tensor(332.7860, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-29 21:34:28,910 - INFO - L2 norm of original vector: tensor(341.6287, device='cuda:0')
2022-09-29 21:34:28,911 - INFO - First two lines of yhat: tensor([[0.0106, 0.0733, 0.6405, 0.3165, 0.1308, 0.1412, 0.0342, 0.0152, 0.9430,
         0.8025, 0.1093, 0.0077, 0.0687, 0.1655, 0.0265, 0.0467, 0.0262, 0.0043,
         0.0349, 0.0422, 0.4134, 0.9887, 0.6503, 0.2322, 0.5183, 0.8472, 0.3118,
         0.7426, 0.5607],
        [0.0088, 0.0977, 0.6286, 0.3151, 0.1340, 0.0939, 0.0463, 0.0149, 0.9492,
         0.8012, 0.1042, 0.0073, 0.0629, 0.2355, 0.0282, 0.0788, 0.0287, 0.0052,
         0.0353, 0.0398, 0.3154, 0.9862, 0.6600, 0.2985, 0.5159, 0.8416, 0.3112,
         0.7283, 0.5586]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:34:28,915 - CRITICAL - Accuracy of the original model: tensor(0.4169, device='cuda:0')
2022-09-29 21:34:44,319 - INFO - >>>>>>>>>>>>>>>>>
2022-09-29 21:34:44,321 - CRITICAL - In epoch 48, loss is tensor(0.0708, device='cuda:0')
2022-09-29 21:34:44,324 - INFO - L2 norm of yhat: tensor(325.6995, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-29 21:34:44,325 - INFO - L2 norm of original vector: tensor(332.4506, device='cuda:0')
2022-09-29 21:34:44,326 - INFO - First two lines of yhat: tensor([[0.0035, 0.0830, 0.5390, 0.3017, 0.1002, 0.0841, 0.0339, 0.0066, 0.9756,
         0.8318, 0.0393, 0.0040, 0.0453, 0.2025, 0.0133, 0.0674, 0.0207, 0.0026,
         0.0151, 0.0244, 0.3371, 0.9920, 0.7235, 0.3084, 0.4616, 0.8384, 0.2917,
         0.6962, 0.5431],
        [0.0057, 0.0674, 0.5341, 0.2961, 0.1034, 0.1286, 0.0248, 0.0071, 0.9665,
         0.8312, 0.0437, 0.0044, 0.0522, 0.1782, 0.0147, 0.0450, 0.0211, 0.0023,
         0.0151, 0.0273, 0.3809, 0.9929, 0.7251, 0.2643, 0.4556, 0.8383, 0.2967,
         0.6935, 0.5481]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:34:44,332 - CRITICAL - Accuracy of the original model: tensor(0.4169, device='cuda:0')
2022-09-29 21:34:58,083 - INFO - >>>>>>>>>>>>>>>>>
2022-09-29 21:34:58,085 - CRITICAL - In epoch 59, loss is tensor(0.0700, device='cuda:0')
2022-09-29 21:34:58,087 - INFO - L2 norm of yhat: tensor(326.7670, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-29 21:34:58,088 - INFO - L2 norm of original vector: tensor(345.6677, device='cuda:0')
2022-09-29 21:34:58,089 - INFO - First two lines of yhat: tensor([[0.0059, 0.0231, 0.5078, 0.2401, 0.0985, 0.2402, 0.0078, 0.0031, 0.9663,
         0.8699, 0.0197, 0.0028, 0.0485, 0.0254, 0.0085, 0.0140, 0.0133, 0.0012,
         0.0054, 0.0195, 0.7160, 0.9958, 0.7357, 0.1551, 0.4253, 0.8395, 0.2786,
         0.6817, 0.5392],
        [0.0020, 0.0688, 0.5017, 0.2600, 0.0993, 0.0871, 0.0281, 0.0036, 0.9854,
         0.8711, 0.0191, 0.0023, 0.0442, 0.1941, 0.0082, 0.0578, 0.0132, 0.0015,
         0.0084, 0.0173, 0.3627, 0.9948, 0.7426, 0.2936, 0.4315, 0.8263, 0.2742,
         0.6781, 0.5342]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:34:58,093 - CRITICAL - Accuracy of the original model: tensor(0.4169, device='cuda:0')
2022-09-29 21:34:58,095 - CRITICAL - 
[FUNCTION]: Testing Generator......
2022-09-29 21:34:58,095 - CRITICAL - Enable Attacker Features
2022-09-29 21:34:58,095 - CRITICAL - Disable Mean Constraint
2022-09-29 21:34:58,106 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-29 21:34:58,106 - CRITICAL - Model output loss: 0.23516055941581726
2022-09-29 21:34:58,106 - CRITICAL - Random guess loss: 0.25939542055130005
2022-09-29 21:34:58,106 - INFO - Model output loss PF: [3.03737252e-05 1.63292319e-01 7.02217221e-02 1.58198237e-01
 9.49908979e-03 1.92672834e-01 7.56887570e-02 8.17198027e-03
 2.65294731e-01 5.02521634e-01 9.66514647e-02 1.39974296e-01
 2.13677377e-01 1.13153592e-01 1.28543392e-01 1.30409509e-01
 1.24860495e-01 8.32947135e-01 6.79538548e-01 1.01042911e-02
 9.16870683e-02 8.51780832e-01 5.43476701e-01 1.43301696e-01
 8.04259479e-02 5.35150766e-01 7.29130954e-02 4.52478588e-01
 1.32990092e-01]
2022-09-29 21:34:58,107 - INFO - Random guess loss PF: [0.35093445 0.09498665 0.20075741 0.33565223 0.32792482 0.35753253
 0.20383909 0.28665191 0.095043   0.23417535 0.12531561 0.24793091
 0.26041856 0.20416722 0.25018936 0.33080414 0.24469589 0.29021496
 0.24650496 0.23450717 0.25588459 0.36537743 0.37138987 0.27511099
 0.18422495 0.34661722 0.27816865 0.31086862 0.2125794 ]
2022-09-29 21:34:58,107 - INFO - Attack result, first 2 samples: tensor([[0.0035, 0.0576, 0.5013, 0.2688, 0.0991, 0.1240, 0.0206, 0.0036, 0.9812,
         0.8714, 0.0197, 0.0024, 0.0470, 0.1905, 0.0079, 0.0456, 0.0146, 0.0014,
         0.0078, 0.0184, 0.3754, 0.9957, 0.7471, 0.2838, 0.4278, 0.8305, 0.2793,
         0.6721, 0.5399],
        [0.0028, 0.0630, 0.4988, 0.2640, 0.0987, 0.1124, 0.0232, 0.0042, 0.9814,
         0.8686, 0.0220, 0.0025, 0.0479, 0.1993, 0.0090, 0.0476, 0.0140, 0.0015,
         0.0084, 0.0194, 0.3602, 0.9958, 0.7520, 0.2946, 0.4322, 0.8301, 0.2791,
         0.6787, 0.5367]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:34:58,114 - INFO - Ground truth, first 2 samples: tensor([[1.6890e-03, 5.5505e-01, 5.9410e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         2.0453e-01, 2.2929e-01, 2.9344e-01, 4.0000e-01, 4.8248e-01, 1.0000e+00,
         4.0000e-01, 9.5545e-01, 3.0816e-02, 0.0000e+00, 3.0823e-02, 1.0000e+00,
         1.0000e+00, 1.0000e-01, 3.1057e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 0.0000e+00, 5.5852e-02, 2.1978e-02, 8.1250e-01],
        [3.6863e-03, 5.6639e-01, 6.3500e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         4.4702e-01, 6.0621e-02, 5.6834e-01, 2.5000e-01, 3.4326e-01, 0.0000e+00,
         5.0000e-01, 7.5925e-01, 2.1591e-02, 0.0000e+00, 1.2901e-01, 1.0000e+00,
         8.0000e-01, 1.0000e-01, 1.4882e-01, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         4.0000e-01, 1.0000e+00, 1.4230e-03, 1.0989e-02, 9.0000e-01]],
       device='cuda:0'):
2022-09-29 21:34:58,131 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-29 21:34:58,131 - CRITICAL - Model output loss: 0.230574369430542
2022-09-29 21:34:58,132 - CRITICAL - Random guess loss: 0.2702328562736511
2022-09-29 21:34:58,132 - INFO - Model output loss PF: [8.51237564e-06 1.49564296e-01 8.11150596e-02 1.51239604e-01
 9.68114287e-03 1.25064015e-01 6.56047687e-02 1.06764007e-02
 2.75588810e-01 5.78965485e-01 1.24357380e-01 1.71070337e-01
 1.81594610e-01 7.86686316e-02 1.52126312e-01 3.04022022e-02
 1.67905718e-01 8.82508874e-01 5.90080738e-01 7.67326681e-03
 9.91872996e-02 7.89767921e-01 5.12469947e-01 1.22041121e-01
 8.40817019e-02 5.85794032e-01 7.28181899e-02 4.44587022e-01
 1.42013475e-01]
2022-09-29 21:34:58,132 - INFO - Random guess loss PF: [0.32587409 0.11270678 0.18260054 0.37692532 0.34040317 0.3015165
 0.13472673 0.26132017 0.08743652 0.28399885 0.14534189 0.40815169
 0.28441161 0.231892   0.27919853 0.31274065 0.22685789 0.30478457
 0.15627009 0.33498856 0.26806295 0.28936666 0.33101386 0.33134991
 0.2025269  0.33807448 0.37156653 0.33345714 0.27918839]
2022-09-29 21:34:58,133 - INFO - Attack result, first 2 samples: tensor([[0.0022, 0.0637, 0.5009, 0.2570, 0.0982, 0.1033, 0.0245, 0.0034, 0.9850,
         0.8726, 0.0194, 0.0023, 0.0460, 0.1878, 0.0077, 0.0459, 0.0125, 0.0014,
         0.0081, 0.0173, 0.3971, 0.9956, 0.7466, 0.2639, 0.4339, 0.8312, 0.2731,
         0.6828, 0.5393],
        [0.0019, 0.0811, 0.5043, 0.2650, 0.0993, 0.0746, 0.0306, 0.0038, 0.9858,
         0.8715, 0.0180, 0.0022, 0.0431, 0.2053, 0.0081, 0.0711, 0.0142, 0.0018,
         0.0084, 0.0169, 0.3258, 0.9938, 0.7487, 0.3091, 0.4296, 0.8274, 0.2754,
         0.6768, 0.5322]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:34:58,139 - INFO - Ground truth, first 2 samples: tensor([[5.6971e-03, 4.5265e-01, 7.0938e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         3.8448e-01, 1.1755e-01, 4.6121e-01, 1.7778e-01, 1.3786e-01, 1.0000e+00,
         3.1389e-01, 3.0965e-02, 3.1279e-02, 0.0000e+00, 4.2749e-01, 8.1869e-01,
         6.0000e-01, 3.3333e-02, 5.6213e-01, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         5.0000e-01, 0.0000e+00, 3.9132e-03, 0.0000e+00, 9.0000e-01],
        [1.9504e-03, 5.1995e-01, 6.0618e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         4.5253e-01, 9.2237e-02, 5.2306e-01, 2.0000e-01, 2.2341e-02, 0.0000e+00,
         2.2500e-01, 4.5098e-02, 4.3143e-02, 0.0000e+00, 4.3155e-02, 4.4350e-02,
         8.0000e-01, 3.3333e-02, 4.3480e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         4.0000e-01, 0.0000e+00, 2.0159e-03, 1.0989e-02, 9.2857e-01]],
       device='cuda:0'):
2022-09-29 21:34:58,156 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-29 21:34:58,156 - CRITICAL - Model output loss: 0.2396164983510971
2022-09-29 21:34:58,158 - CRITICAL - Random guess loss: 0.2615901231765747
2022-09-29 21:34:58,158 - INFO - Model output loss PF: [1.17577538e-05 1.80635005e-01 6.13322109e-02 1.65198952e-01
 9.62555222e-03 1.46594763e-01 5.23239821e-02 1.17736952e-02
 2.88338721e-01 5.82670689e-01 9.82819498e-02 2.33198792e-01
 1.28922388e-01 1.20301075e-01 1.62042275e-01 5.98493069e-02
 8.16487819e-02 9.00027871e-01 6.40213966e-01 1.24620246e-02
 1.11901879e-01 9.13836837e-01 5.01314342e-01 1.38714164e-01
 7.63218030e-02 6.19443893e-01 7.29015097e-02 4.43642676e-01
 1.35347575e-01]
2022-09-29 21:34:58,158 - INFO - Random guess loss PF: [0.30915272 0.09488998 0.12353635 0.32787108 0.3720777  0.35837787
 0.18611863 0.28360596 0.0725075  0.21867625 0.16134463 0.34836179
 0.25215471 0.27519804 0.23866989 0.354855   0.21030173 0.28397903
 0.23497067 0.26364177 0.2022917  0.30528396 0.30681485 0.3341347
 0.23620486 0.3706066  0.27698079 0.29011375 0.29339114]
2022-09-29 21:34:58,159 - INFO - Attack result, first 2 samples: tensor([[0.0050, 0.0277, 0.5093, 0.2416, 0.0982, 0.2097, 0.0093, 0.0027, 0.9738,
         0.8724, 0.0198, 0.0024, 0.0496, 0.0477, 0.0082, 0.0179, 0.0114, 0.0010,
         0.0059, 0.0200, 0.6098, 0.9968, 0.7267, 0.1810, 0.4272, 0.8367, 0.2756,
         0.6891, 0.5390],
        [0.0079, 0.0209, 0.4974, 0.2425, 0.0990, 0.2920, 0.0067, 0.0030, 0.9651,
         0.8682, 0.0214, 0.0030, 0.0537, 0.0243, 0.0091, 0.0116, 0.0136, 0.0014,
         0.0056, 0.0245, 0.7548, 0.9959, 0.7142, 0.1300, 0.4278, 0.8298, 0.2746,
         0.6868, 0.5430]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:34:58,166 - INFO - Ground truth, first 2 samples: tensor([[2.3995e-03, 4.0028e-01, 8.0787e-01, 0.0000e+00, 9.5969e-04, 1.0000e+00,
         1.7289e-01, 1.1629e-01, 4.1287e-01, 0.0000e+00, 2.1323e-01, 0.0000e+00,
         0.0000e+00, 3.5977e-02, 3.5952e-02, 0.0000e+00, 3.5959e-02, 1.0000e+00,
         1.0000e+00, 5.0000e-02, 9.4203e-01, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         4.0000e-01, 0.0000e+00, 0.0000e+00, 0.0000e+00, 9.5000e-01],
        [0.0000e+00, 4.1933e-01, 7.6146e-01, 1.0000e+00, 9.5969e-04, 0.0000e+00,
         2.7058e-01, 1.7500e-01, 4.0659e-01, 1.0000e+00, 4.4673e-01, 1.0000e+00,
         1.0000e+00, 5.3972e-02, 8.6278e-01, 0.0000e+00, 5.3949e-02, 1.0000e+00,
         8.0000e-01, 1.0000e-01, 5.4356e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 0.0000e+00, 1.5416e-03, 2.1978e-02, 9.7500e-01]],
       device='cuda:0'):
2022-09-29 21:34:58,184 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-29 21:34:58,184 - CRITICAL - Model output loss: 0.2252502292394638
2022-09-29 21:34:58,184 - CRITICAL - Random guess loss: 0.2614525556564331
2022-09-29 21:34:58,184 - INFO - Model output loss PF: [9.97058487e-06 1.52032137e-01 6.41240329e-02 1.34166196e-01
 9.52567533e-03 1.05861679e-01 6.73751831e-02 1.19616035e-02
 2.94832885e-01 5.51086366e-01 1.05045438e-01 1.24415964e-01
 1.50795460e-01 1.00693084e-01 1.03715457e-01 5.96985221e-02
 1.28237829e-01 8.98998499e-01 6.32293761e-01 1.16171064e-02
 9.62101072e-02 8.20433855e-01 5.05811393e-01 1.49278894e-01
 6.78410381e-02 5.24029076e-01 7.22711384e-02 4.52260554e-01
 1.37633562e-01]
2022-09-29 21:34:58,185 - INFO - Random guess loss PF: [0.43139824 0.08584775 0.18355933 0.3448326  0.29547399 0.25483957
 0.15896109 0.29725367 0.10637037 0.2663886  0.09605273 0.36469853
 0.20148905 0.27664959 0.20390996 0.34292045 0.2241876  0.26791194
 0.26612192 0.23501359 0.22221282 0.31952065 0.39835313 0.32588214
 0.15600929 0.32935604 0.35399863 0.30278379 0.2701267 ]
2022-09-29 21:34:58,185 - INFO - Attack result, first 2 samples: tensor([[0.0019, 0.0815, 0.5021, 0.2659, 0.0995, 0.0726, 0.0318, 0.0039, 0.9857,
         0.8708, 0.0183, 0.0022, 0.0429, 0.2105, 0.0080, 0.0738, 0.0140, 0.0018,
         0.0087, 0.0171, 0.3130, 0.9940, 0.7450, 0.3191, 0.4307, 0.8262, 0.2747,
         0.6767, 0.5337],
        [0.0021, 0.0703, 0.5008, 0.2591, 0.0989, 0.0891, 0.0265, 0.0036, 0.9849,
         0.8708, 0.0188, 0.0021, 0.0445, 0.2000, 0.0082, 0.0545, 0.0131, 0.0015,
         0.0081, 0.0178, 0.3639, 0.9952, 0.7470, 0.2948, 0.4292, 0.8274, 0.2744,
         0.6790, 0.5336]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:34:58,189 - INFO - Ground truth, first 2 samples: tensor([[2.9390e-03, 3.6522e-01, 7.0324e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         2.3547e-01, 7.4244e-02, 4.6184e-01, 3.5000e-01, 2.3276e-01, 0.0000e+00,
         6.5000e-01, 3.0977e-02, 3.0816e-02, 0.0000e+00, 3.0823e-02, 1.0000e+00,
         1.0000e+00, 1.3636e-01, 3.1056e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         5.0000e-01, 1.0000e+00, 9.4865e-04, 0.0000e+00, 9.7500e-01],
        [6.7024e-03, 3.6275e-01, 8.7500e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         6.5246e-01, 7.8368e-02, 5.5211e-01, 3.3333e-02, 3.7531e-01, 0.0000e+00,
         6.6667e-02, 4.3175e-02, 4.3308e-02, 0.0000e+00, 6.9284e-01, 1.0000e+00,
         5.0000e-01, 3.3333e-02, 4.3522e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         8.7500e-01, 0.0000e+00, 5.2176e-03, 0.0000e+00, 8.7500e-01]],
       device='cuda:0'):
2022-09-29 21:34:58,203 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-29 21:34:58,203 - CRITICAL - Model output loss: 0.22790871560573578
2022-09-29 21:34:58,203 - CRITICAL - Random guess loss: 0.26136958599090576
2022-09-29 21:34:58,203 - INFO - Model output loss PF: [6.48210334e-06 1.52686387e-01 5.98115362e-02 1.58194155e-01
 9.59145650e-03 1.48086682e-01 7.29066133e-02 1.47289932e-02
 3.00295115e-01 5.65017045e-01 9.29154903e-02 1.55488953e-01
 1.81806475e-01 7.19745457e-02 1.75298497e-01 3.03130150e-02
 6.72945753e-02 8.73331189e-01 5.99327683e-01 9.23077576e-03
 1.04596592e-01 8.66742373e-01 5.18991768e-01 1.18189424e-01
 7.28876367e-02 5.34391880e-01 7.26312399e-02 4.48404133e-01
 1.34211957e-01]
2022-09-29 21:34:58,204 - INFO - Random guess loss PF: [0.38005698 0.10220137 0.15174893 0.2850914  0.37471643 0.28618446
 0.1488768  0.26583844 0.09286192 0.26427129 0.18469916 0.37469766
 0.25431216 0.22960156 0.2453385  0.34358603 0.23476151 0.31892422
 0.19683158 0.29126906 0.26439014 0.29422814 0.31242263 0.2784386
 0.1471142  0.35124609 0.34991592 0.31785804 0.23823422]
2022-09-29 21:34:58,204 - INFO - Attack result, first 2 samples: tensor([[2.0302e-03, 6.7281e-02, 5.0048e-01, 2.5673e-01, 9.9033e-02, 8.5185e-02,
         2.6978e-02, 3.3784e-03, 9.8517e-01, 8.7165e-01, 1.8669e-02, 2.0948e-03,
         4.3296e-02, 1.9081e-01, 7.8068e-03, 5.5772e-02, 1.2530e-02, 1.4916e-03,
         7.3689e-03, 1.7642e-02, 3.6279e-01, 9.9483e-01, 7.5084e-01, 3.0142e-01,
         4.3444e-01, 8.2759e-01, 2.7613e-01, 6.7328e-01, 5.3515e-01],
        [3.6705e-03, 3.9181e-02, 5.0407e-01, 2.4900e-01, 9.8698e-02, 1.6625e-01,
         1.2520e-02, 2.9286e-03, 9.7540e-01, 8.7444e-01, 2.0538e-02, 2.3784e-03,
         4.7294e-02, 8.4071e-02, 8.0416e-03, 2.3104e-02, 1.1183e-02, 9.6588e-04,
         6.7487e-03, 1.8759e-02, 4.9885e-01, 9.9691e-01, 7.4102e-01, 2.1083e-01,
         4.2603e-01, 8.3624e-01, 2.7454e-01, 6.8667e-01, 5.3790e-01]],
       device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:34:58,208 - INFO - Ground truth, first 2 samples: tensor([[3.3277e-03, 3.2701e-01, 7.3168e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         1.2329e-01, 2.2459e-01, 2.7590e-01, 0.0000e+00, 2.6435e-01, 0.0000e+00,
         3.5714e-01, 2.4026e-02, 9.8222e-01, 0.0000e+00, 2.4323e-02, 1.0000e+00,
         5.0000e-01, 1.0000e-01, 2.4179e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 1.0000e+00, 7.1505e-02, 2.1978e-02, 9.7500e-01],
        [9.3499e-04, 4.7360e-01, 7.5972e-01, 1.0000e+00, 9.5969e-04, 0.0000e+00,
         2.2844e-01, 8.8646e-02, 4.7533e-01, 0.0000e+00, 3.4722e-01, 0.0000e+00,
         0.0000e+00, 2.6983e-02, 9.7067e-01, 0.0000e+00, 2.6970e-02, 1.0000e+00,
         1.0000e+00, 1.0000e-01, 2.7175e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         5.0000e-01, 0.0000e+00, 2.3716e-03, 2.1978e-02, 9.5000e-01]],
       device='cuda:0'):
2022-09-29 21:34:58,222 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-29 21:34:58,222 - CRITICAL - Model output loss: 0.23057539761066437
2022-09-29 21:34:58,222 - CRITICAL - Random guess loss: 0.2610522508621216
2022-09-29 21:34:58,222 - INFO - Model output loss PF: [3.07769005e-05 1.64814427e-01 7.24378824e-02 1.51002169e-01
 9.55291092e-03 1.02067895e-01 6.50703013e-02 9.68742743e-03
 2.81576395e-01 6.20372415e-01 1.12084456e-01 1.55499816e-01
 1.16150916e-01 8.82915109e-02 1.84448659e-01 5.68009764e-02
 1.27126962e-01 8.63903403e-01 6.03919268e-01 7.95633532e-03
 9.23307091e-02 8.35802197e-01 4.99955952e-01 1.51545912e-01
 8.82308930e-02 5.65799356e-01 7.40364268e-02 4.55995172e-01
 1.30194694e-01]
2022-09-29 21:34:58,223 - INFO - Random guess loss PF: [0.34178603 0.11165245 0.15738264 0.32969493 0.3539561  0.37118453
 0.13114271 0.16089649 0.09866447 0.3086898  0.15013629 0.26117134
 0.17656618 0.21792798 0.25121737 0.31587958 0.29807776 0.44246227
 0.15928102 0.29056886 0.29015565 0.27455133 0.31402004 0.28378057
 0.19346224 0.38230848 0.33042049 0.36132383 0.21215396]
2022-09-29 21:34:58,223 - INFO - Attack result, first 2 samples: tensor([[0.0033, 0.0485, 0.5095, 0.2657, 0.1035, 0.1572, 0.0157, 0.0035, 0.9802,
         0.8723, 0.0223, 0.0023, 0.0492, 0.1349, 0.0088, 0.0297, 0.0127, 0.0011,
         0.0071, 0.0211, 0.4376, 0.9961, 0.7308, 0.2073, 0.4226, 0.8352, 0.2740,
         0.6856, 0.5322],
        [0.0019, 0.0819, 0.5030, 0.2689, 0.0993, 0.0704, 0.0317, 0.0039, 0.9856,
         0.8711, 0.0179, 0.0022, 0.0426, 0.2070, 0.0081, 0.0747, 0.0142, 0.0018,
         0.0085, 0.0171, 0.3210, 0.9938, 0.7497, 0.3184, 0.4276, 0.8258, 0.2753,
         0.6744, 0.5328]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:34:58,227 - INFO - Ground truth, first 2 samples: tensor([[2.0777e-03, 0.0000e+00, 1.0000e+00, 0.0000e+00, 0.0000e+00, 1.0000e+00,
         0.0000e+00, 0.0000e+00, 3.5106e-01, 0.0000e+00, 2.1090e-01, 0.0000e+00,
         0.0000e+00, 3.5977e-02, 3.5953e-02, 0.0000e+00, 3.5960e-02, 1.0000e+00,
         0.0000e+00, 0.0000e+00, 9.4203e-01, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         1.0000e+00, 0.0000e+00, 0.0000e+00, 1.0989e-02, 1.0000e+00],
        [4.0214e-03, 5.0229e-01, 6.2500e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         2.9234e-01, 8.1930e-02, 5.2799e-01, 0.0000e+00, 2.3733e-01, 1.0000e+00,
         0.0000e+00, 2.7086e-02, 2.7037e-02, 0.0000e+00, 2.6969e-02, 1.0000e+00,
         9.0000e-01, 2.0000e-01, 2.7174e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         2.5000e-01, 0.0000e+00, 1.1704e-03, 1.0989e-02, 8.7500e-01]],
       device='cuda:0'):
2022-09-29 21:34:58,241 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-29 21:34:58,241 - CRITICAL - Model output loss: 0.22707031667232513
2022-09-29 21:34:58,241 - CRITICAL - Random guess loss: 0.2488049417734146
2022-09-29 21:34:58,241 - INFO - Model output loss PF: [1.52502334e-05 1.60473615e-01 7.88734034e-02 1.43144637e-01
 9.45986994e-03 1.58939183e-01 5.73771521e-02 9.72431246e-03
 2.88239807e-01 6.03558362e-01 8.74697864e-02 1.71059772e-01
 1.39850169e-01 8.04929659e-02 1.69896811e-01 3.06686517e-02
 1.07994743e-01 7.74099231e-01 6.25540376e-01 7.78202666e-03
 1.04661040e-01 8.20589781e-01 4.82717723e-01 1.51950985e-01
 9.01697725e-02 5.77799201e-01 7.30482638e-02 4.50452179e-01
 1.28990397e-01]
2022-09-29 21:34:58,242 - INFO - Random guess loss PF: [0.29173756 0.08708575 0.17485464 0.30575889 0.28589821 0.34304118
 0.17411965 0.24835213 0.07726376 0.26142269 0.14899899 0.34107813
 0.25966614 0.26286882 0.20390582 0.29944557 0.32164291 0.27935505
 0.19349642 0.18651858 0.25947496 0.34630173 0.27413893 0.28853846
 0.14846182 0.30662578 0.33723614 0.28226736 0.2257873 ]
2022-09-29 21:34:58,242 - INFO - Attack result, first 2 samples: tensor([[4.0319e-03, 3.1584e-02, 5.1014e-01, 2.5276e-01, 9.6248e-02, 1.9799e-01,
         1.0449e-02, 3.0187e-03, 9.7713e-01, 8.7204e-01, 2.0014e-02, 2.3417e-03,
         4.7396e-02, 6.2277e-02, 7.6449e-03, 1.9908e-02, 1.1296e-02, 9.7240e-04,
         6.0675e-03, 2.0640e-02, 5.5967e-01, 9.9685e-01, 7.3710e-01, 1.9776e-01,
         4.2758e-01, 8.3725e-01, 2.7371e-01, 6.9096e-01, 5.4189e-01],
        [2.2325e-03, 6.6977e-02, 5.1028e-01, 2.6086e-01, 9.6704e-02, 9.6449e-02,
         2.3540e-02, 3.6224e-03, 9.8415e-01, 8.7343e-01, 1.8786e-02, 2.2593e-03,
         4.3760e-02, 2.0547e-01, 7.7987e-03, 5.4262e-02, 1.3104e-02, 1.3740e-03,
         7.8862e-03, 1.7246e-02, 3.4693e-01, 9.9579e-01, 7.5053e-01, 2.9384e-01,
         4.3111e-01, 8.3327e-01, 2.7316e-01, 6.8257e-01, 5.3688e-01]],
       device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:34:58,247 - INFO - Ground truth, first 2 samples: tensor([[1.4410e-03, 4.2149e-01, 7.5119e-01, 0.0000e+00, 9.5969e-04, 1.0000e+00,
         1.4785e-01, 1.0877e-01, 3.4971e-01, 0.0000e+00, 2.2386e-01, 0.0000e+00,
         0.0000e+00, 2.3984e-02, 2.4108e-02, 0.0000e+00, 2.4116e-02, 1.0000e+00,
         4.0000e-01, 1.0000e-01, 9.9005e-01, 1.0000e+00, 0.0000e+00, 0.0000e+00,
         6.0000e-01, 0.0000e+00, 1.8973e-03, 0.0000e+00, 8.7500e-01],
        [1.4879e-03, 5.0089e-01, 7.7812e-01, 0.0000e+00, 9.5969e-04, 1.0000e+00,
         6.1840e-01, 1.3865e-01, 5.5858e-01, 2.5000e-01, 3.1946e-01, 0.0000e+00,
         5.0000e-01, 4.2056e-01, 2.1584e-02, 0.0000e+00, 4.8523e-01, 7.3272e-01,
         9.0000e-01, 1.0000e-01, 1.3091e-01, 0.0000e+00, 1.0000e+00, 1.0000e+00,
         7.0000e-01, 0.0000e+00, 1.2925e-02, 1.0989e-02, 8.5000e-01]],
       device='cuda:0'):
2022-09-29 21:34:58,261 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-29 21:34:58,261 - CRITICAL - Model output loss: 0.23824095726013184
2022-09-29 21:34:58,263 - CRITICAL - Random guess loss: 0.25715819001197815
2022-09-29 21:34:58,264 - INFO - Model output loss PF: [1.33935691e-05 1.53305411e-01 7.44969100e-02 1.66004732e-01
 9.49687604e-03 1.22999713e-01 6.17859550e-02 1.62014477e-02
 2.95676172e-01 5.21635294e-01 1.07324064e-01 2.33313441e-01
 2.03293622e-01 1.34242088e-01 1.67889953e-01 6.18087985e-02
 9.89430994e-02 8.41264606e-01 6.65128112e-01 1.33831203e-02
 9.97069329e-02 8.51517260e-01 5.36079764e-01 1.25141531e-01
 9.90393683e-02 5.98307371e-01 7.32700080e-02 4.44205076e-01
 1.33513287e-01]
2022-09-29 21:34:58,264 - INFO - Random guess loss PF: [0.35604343 0.0907362  0.17060992 0.34630686 0.3635858  0.32918805
 0.1498211  0.21459804 0.1120767  0.25136843 0.15009993 0.29369137
 0.20420696 0.23860808 0.26139155 0.38421685 0.23000753 0.28196955
 0.18792811 0.24070334 0.233123   0.35755467 0.32104805 0.30376613
 0.16529581 0.35451341 0.28940853 0.32781875 0.24790163]
2022-09-29 21:34:58,264 - INFO - Attack result, first 2 samples: tensor([[0.0044, 0.0501, 0.5007, 0.2571, 0.1066, 0.1662, 0.0187, 0.0041, 0.9758,
         0.8667, 0.0249, 0.0030, 0.0510, 0.1584, 0.0095, 0.0339, 0.0157, 0.0016,
         0.0090, 0.0201, 0.4379, 0.9957, 0.7321, 0.2203, 0.4341, 0.8334, 0.2841,
         0.6805, 0.5399],
        [0.0033, 0.0574, 0.4994, 0.2640, 0.1020, 0.1359, 0.0195, 0.0038, 0.9819,
         0.8677, 0.0209, 0.0024, 0.0475, 0.1829, 0.0089, 0.0437, 0.0140, 0.0013,
         0.0079, 0.0200, 0.3698, 0.9954, 0.7440, 0.2807, 0.4259, 0.8323, 0.2758,
         0.6809, 0.5358]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:34:58,271 - INFO - Ground truth, first 2 samples: tensor([[5.8981e-04, 4.3515e-01, 6.7623e-01, 0.0000e+00, 9.5969e-04, 1.0000e+00,
         1.8711e-01, 1.0399e-01, 4.2178e-01, 0.0000e+00, 4.3137e-01, 0.0000e+00,
         0.0000e+00, 5.5235e-01, 5.3931e-02, 0.0000e+00, 5.3943e-02, 1.0000e+00,
         1.0000e+00, 6.2500e-02, 3.6677e-01, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 0.0000e+00, 9.4272e-04, 0.0000e+00, 9.5000e-01],
        [1.3405e-03, 4.9360e-01, 7.9643e-01, 1.0000e+00, 9.5969e-04, 0.0000e+00,
         3.1397e-01, 5.1094e-02, 5.8134e-01, 0.0000e+00, 3.8610e-02, 0.0000e+00,
         0.0000e+00, 2.1768e-02, 5.5067e-01, 0.0000e+00, 2.1809e-02, 9.5340e-02,
         1.0000e+00, 1.0000e-01, 4.6629e-01, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         6.0000e-01, 1.0000e+00, 1.5416e-03, 0.0000e+00, 9.2857e-01]],
       device='cuda:0'):
2022-09-29 21:34:58,289 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-29 21:34:58,289 - CRITICAL - Model output loss: 0.23064474761486053
2022-09-29 21:34:58,289 - CRITICAL - Random guess loss: 0.251406729221344
2022-09-29 21:34:58,289 - INFO - Model output loss PF: [7.55858173e-06 1.67773411e-01 6.46996498e-02 1.43301368e-01
 9.56631824e-03 1.26724169e-01 6.89598247e-02 1.00343246e-02
 2.78593481e-01 5.15460372e-01 1.03499986e-01 2.02186197e-01
 2.09809124e-01 1.12111315e-01 1.04050368e-01 5.68139590e-02
 1.64007813e-01 8.12424600e-01 6.26699209e-01 2.57479474e-02
 9.38440859e-02 8.36023808e-01 5.13180554e-01 1.34343684e-01
 8.47158581e-02 5.66239119e-01 7.42614046e-02 4.51127052e-01
 1.32491350e-01]
2022-09-29 21:34:58,290 - INFO - Random guess loss PF: [0.35899633 0.07488608 0.15335967 0.31631932 0.30958277 0.32216561
 0.12029789 0.23909234 0.0851551  0.23364472 0.13654467 0.32545713
 0.2446817  0.2242505  0.19915439 0.37277952 0.26351514 0.32450321
 0.20159224 0.21867043 0.20473021 0.25513229 0.40494448 0.37589607
 0.1518435  0.27184844 0.3219521  0.33591506 0.24388467]
2022-09-29 21:34:58,290 - INFO - Attack result, first 2 samples: tensor([[0.0019, 0.0795, 0.5011, 0.2622, 0.0998, 0.0772, 0.0310, 0.0038, 0.9860,
         0.8702, 0.0183, 0.0022, 0.0435, 0.2051, 0.0080, 0.0689, 0.0140, 0.0018,
         0.0085, 0.0173, 0.3407, 0.9938, 0.7462, 0.3124, 0.4291, 0.8254, 0.2745,
         0.6781, 0.5334],
        [0.0052, 0.0244, 0.5130, 0.2468, 0.0973, 0.2356, 0.0077, 0.0029, 0.9727,
         0.8718, 0.0205, 0.0025, 0.0477, 0.0396, 0.0076, 0.0149, 0.0116, 0.0011,
         0.0054, 0.0209, 0.6561, 0.9967, 0.7128, 0.1560, 0.4320, 0.8430, 0.2731,
         0.6877, 0.5444]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:34:58,297 - INFO - Ground truth, first 2 samples: tensor([[2.5737e-03, 4.3405e-01, 6.8817e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         1.4223e-01, 9.7161e-02, 4.2147e-01, 1.0000e+00, 3.1087e-01, 0.0000e+00,
         1.0000e+00, 6.7646e-01, 3.0815e-02, 0.0000e+00, 3.0823e-02, 1.0000e+00,
         1.0000e+00, 6.2500e-02, 3.1204e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         2.0000e-01, 1.0000e+00, 9.4272e-04, 0.0000e+00, 9.5000e-01],
        [2.7983e-03, 3.3650e-01, 6.8958e-01, 0.0000e+00, 9.5969e-04, 1.0000e+00,
         1.9613e-01, 5.4967e-02, 3.9937e-01, 5.0000e-01, 2.7590e-01, 1.0000e+00,
         5.0000e-01, 2.1586e-02, 1.2981e-01, 0.0000e+00, 2.1575e-02, 1.0000e+00,
         7.5000e-01, 6.2500e-02, 8.9091e-01, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 0.0000e+00, 1.6601e-03, 0.0000e+00, 9.0000e-01]],
       device='cuda:0'):
2022-09-29 21:34:58,314 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-29 21:34:58,314 - CRITICAL - Model output loss: 0.23272790014743805
2022-09-29 21:34:58,316 - CRITICAL - Random guess loss: 0.2630336880683899
2022-09-29 21:34:58,317 - INFO - Model output loss PF: [1.68803526e-05 1.69661418e-01 5.56265935e-02 1.20064333e-01
 9.54985525e-03 1.69263333e-01 6.36843443e-02 1.44259594e-02
 3.01242352e-01 5.23875594e-01 1.49006352e-01 1.71062797e-01
 2.30122611e-01 1.42452016e-01 9.95348766e-02 1.71178468e-02
 1.38152808e-01 9.13653851e-01 6.10517323e-01 9.84619372e-03
 1.06689408e-01 8.36420536e-01 5.19304752e-01 1.12990752e-01
 7.45500401e-02 5.46802402e-01 7.31464773e-02 4.40043658e-01
 1.30283773e-01]
2022-09-29 21:34:58,317 - INFO - Random guess loss PF: [0.31990436 0.11441217 0.13042547 0.37304407 0.3823058  0.31590861
 0.19161257 0.22008961 0.08729392 0.29709923 0.10216735 0.3586967
 0.24913546 0.25141329 0.21182197 0.3020649  0.28005674 0.25743896
 0.20108478 0.2590811  0.32966703 0.36995512 0.31135619 0.33973312
 0.16759066 0.36312771 0.37198332 0.23495585 0.23455134]
2022-09-29 21:34:58,318 - INFO - Attack result, first 2 samples: tensor([[0.0046, 0.0314, 0.5109, 0.2572, 0.0997, 0.1934, 0.0104, 0.0034, 0.9732,
         0.8685, 0.0203, 0.0025, 0.0483, 0.0532, 0.0075, 0.0226, 0.0127, 0.0012,
         0.0065, 0.0190, 0.5763, 0.9964, 0.7359, 0.1881, 0.4338, 0.8365, 0.2778,
         0.6803, 0.5398],
        [0.0019, 0.0722, 0.5027, 0.2626, 0.1002, 0.0851, 0.0294, 0.0036, 0.9862,
         0.8709, 0.0189, 0.0023, 0.0444, 0.1973, 0.0079, 0.0595, 0.0140, 0.0018,
         0.0083, 0.0171, 0.3812, 0.9942, 0.7436, 0.2984, 0.4269, 0.8248, 0.2741,
         0.6789, 0.5362]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:34:58,325 - INFO - Ground truth, first 2 samples: tensor([[9.3834e-03, 3.6046e-01, 7.3924e-01, 0.0000e+00, 9.5969e-04, 1.0000e+00,
         1.6058e-01, 8.1010e-02, 4.2846e-01, 1.3636e-01, 2.7286e-01, 0.0000e+00,
         4.5455e-01, 2.1611e-02, 3.7570e-01, 0.0000e+00, 2.1577e-02, 1.0000e+00,
         8.0000e-01, 5.0000e-02, 6.4308e-01, 0.0000e+00, 1.0000e+00, 1.0000e+00,
         5.0000e-01, 0.0000e+00, 0.0000e+00, 0.0000e+00, 8.7500e-01],
        [2.7145e-03, 4.6787e-01, 5.4167e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         4.1944e-01, 9.4042e-02, 5.4570e-01, 1.6667e-01, 5.8542e-01, 0.0000e+00,
         1.6667e-01, 3.5977e-02, 7.4188e-01, 0.0000e+00, 2.2881e-01, 1.0000e+00,
         1.0000e+00, 1.0000e-01, 3.6257e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 1.0000e+00, 2.2531e-03, 0.0000e+00, 8.3333e-01]],
       device='cuda:0'):
2022-09-29 21:34:59,732 - CRITICAL - ------------------ SUMMARY ------------------
2022-09-29 21:34:59,732 - CRITICAL - Mean generator loss: 0.23228725466516711
2022-09-29 21:34:59,734 - CRITICAL - Mean random guess loss: 0.2607364470679914
2022-09-29 21:34:59,734 - CRITICAL - Mean generator loss Per Feature: [1.66604518e-04 1.61179356e-01 7.36337569e-02 1.56688177e-01
 9.65518521e-03 1.42163195e-01 6.65294905e-02 1.09806953e-02
 2.80673478e-01 5.62064565e-01 1.06711386e-01 1.85086979e-01
 1.60311697e-01 9.66754113e-02 1.60103045e-01 6.09021518e-02
 1.15979090e-01 8.49377773e-01 6.20575368e-01 1.11216422e-02
 9.94227996e-02 8.48770321e-01 5.16916131e-01 1.31952468e-01
 8.82190733e-02 5.63964122e-01 7.34974166e-02 4.47109761e-01
 1.35899280e-01]
2022-09-29 21:34:59,735 - CRITICAL - Mean random guess loss Per Feature: [0.33201711 0.10052502 0.15974374 0.32921476 0.3351273  0.33615433
 0.15615178 0.25357165 0.09050153 0.25307424 0.14672419 0.33251135
 0.23603862 0.24994034 0.24244892 0.33605381 0.25642792 0.30230209
 0.21001542 0.25279263 0.25292202 0.32886585 0.33667542 0.33391328
 0.16777788 0.33202711 0.32683924 0.32561285 0.2453866 ]
2022-09-29 21:34:59,737 - CRITICAL - Accuracy: tensor(0., device='cuda:0')
2022-09-29 21:34:59,738 - CRITICAL - Accur: tensor(0., device='cuda:0')
2022-09-29 21:34:59,739 - CRITICAL - Accur: 7930.0
2022-09-29 21:34:59,739 - CRITICAL - 2m 21s (- 2m 21s) (50%)
2022-09-29 21:34:59,739 - CRITICAL - 

<----------------- Running count: 2 / 2 ----------------->


2022-09-29 21:35:02,366 - CRITICAL - Dataset column permutation is: 
 tensor([28,  6, 12, 49, 56,  9, 52,  5,  0, 15, 47, 13, 58,  7, 57, 45,  1, 34,
        23, 10, 40, 16, 41, 35, 30, 32, 46, 19, 44, 26, 50, 14, 39, 53, 43,  8,
        17, 18, 21,  3, 11, 36, 54, 27, 48, 24, 31, 29, 38, 25, 42,  4, 37, 51,
        22,  2, 33, 55, 20])
2022-09-29 21:35:02,381 - CRITICAL - Creating dataset, len(samples): 39644; positive labels sum: 34720
2022-09-29 21:35:02,403 - CRITICAL - For dataset C:\Haider\Research\InferenceAttacksDefenses\featureinference-vfl\datasets\news_cleaned.csv, dataset length: 39644
2022-09-29 21:35:02,403 - CRITICAL - 
[FUNCTION]: Splitting dataset by getSplittedDataset()......
2022-09-29 21:35:02,406 - INFO - Display first (x, y) pair of dataset:
 tensor([5.8817e-04, 1.3158e-02, 0.0000e+00, 3.7864e-01, 4.0625e-01, 0.0000e+00,
        6.5000e-01, 1.2544e-03, 1.0000e+00, 0.0000e+00, 7.6923e-01, 1.0000e+00,
        1.8750e-01, 1.7241e-02, 0.0000e+00, 2.9367e-01, 4.7619e-01, 0.0000e+00,
        0.0000e+00, 5.8202e-01, 4.3483e-02, 0.0000e+00, 4.4534e-02, 0.0000e+00,
        1.0000e+00, 0.0000e+00, 7.4074e-02, 0.0000e+00, 4.3359e-01, 0.0000e+00,
        1.0000e-01, 0.0000e+00, 4.0853e-01, 4.0000e-01, 5.2162e-01, 7.8125e-03,
        0.0000e+00, 2.6455e-03, 0.0000e+00, 9.4664e-04, 4.4444e-01, 0.0000e+00,
        8.0000e-01, 5.8817e-04, 2.3077e-01, 2.7670e-04, 0.0000e+00, 5.8817e-04,
        5.3973e-01, 0.0000e+00, 4.3273e-02, 9.5969e-04, 0.0000e+00, 7.0000e-01,
        0.0000e+00, 2.5844e-02, 0.0000e+00, 5.0000e-01, 2.3349e-05]), tensor(0.)
2022-09-29 21:35:02,407 - INFO - Shape of (x, y): torch.Size([59]) torch.Size([])
2022-09-29 21:35:02,409 - CRITICAL - len(trainset): 23786
2022-09-29 21:35:02,411 - CRITICAL - len(testset): 7928
2022-09-29 21:35:02,411 - CRITICAL - len(predictset): 7930
2022-09-29 21:35:02,414 - INFO - len(trainloader): 372
2022-09-29 21:35:02,415 - INFO - len(testloader): 124
2022-09-29 21:35:02,415 - INFO - len(predictloader): 124
2022-09-29 21:35:02,415 - CRITICAL - 
[FUNCTION]: Creating GlobalClassifierTrainer......
2022-09-29 21:35:02,415 - CRITICAL - Creating a model for type RF
2022-09-29 21:35:02,416 - CRITICAL - Creating RandomForest, with n_estimators=100, max_depth=3
2022-09-29 21:35:02,431 - INFO - Structure of Fake Random Forest: FakeRandomForest(
  (dense): Sequential(
    (0): Linear(in_features=59, out_features=2000, bias=True)
    (1): Dropout(p=0.5, inplace=False)
    (2): ReLU()
    (3): Linear(in_features=2000, out_features=200, bias=True)
    (4): Dropout(p=0.5, inplace=False)
    (5): ReLU()
    (6): Linear(in_features=200, out_features=5, bias=True)
    (7): Sigmoid()
  )
)
2022-09-29 21:35:02,431 - INFO - Structure of Global Classifier: RandomForestClassifier(max_depth=3, random_state=0)
2022-09-29 21:35:02,435 - CRITICAL - 
[FUNCTION]: Creating GeneratorTrainer......
2022-09-29 21:35:02,436 - CRITICAL - Creating a generator
2022-09-29 21:35:02,442 - INFO - Structure of Generator: Generator(
  (net): Sequential(
    (0): Linear(in_features=59, out_features=600, bias=True)
    (1): LayerNorm((600,), eps=1e-05, elementwise_affine=True)
    (2): ReLU()
    (3): Linear(in_features=600, out_features=200, bias=True)
    (4): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
    (5): ReLU()
    (6): Linear(in_features=200, out_features=100, bias=True)
    (7): LayerNorm((100,), eps=1e-05, elementwise_affine=True)
    (8): ReLU()
    (9): Linear(in_features=100, out_features=29, bias=True)
    (10): Sigmoid()
  )
)
2022-09-29 21:35:02,442 - CRITICAL - 
[FUNCTION]: Training global classifier RF......
2022-09-29 21:35:05,420 - CRITICAL - After training Random Forest, train accur is 0.419826788867401, test accur is 0.4158678102926337.
2022-09-29 21:35:09,024 - CRITICAL - Creating FakeDataset (torch.Size([396440, 59]), torch.Size([396440, 5]))
2022-09-29 21:35:09,035 - CRITICAL - 
[FUNCTION]: Imitating Random Forest......
2022-09-29 21:35:22,534 - CRITICAL - In epoch 0, train loss is 0.00021632910647895187, test loss is 8.518796676071361e-05.
2022-09-29 21:35:36,123 - CRITICAL - In epoch 1, train loss is 0.00011647291103145108, test loss is 5.5808774050092325e-05.
2022-09-29 21:35:49,399 - CRITICAL - In epoch 2, train loss is 5.956770837656222e-05, test loss is 4.8728325054980814e-05.
2022-09-29 21:36:02,692 - CRITICAL - In epoch 3, train loss is 5.231325121712871e-05, test loss is 4.8237881856039166e-05.
2022-09-29 21:36:16,163 - CRITICAL - In epoch 4, train loss is 4.615884608938359e-05, test loss is 4.3323107092874125e-05.
2022-09-29 21:36:16,167 - CRITICAL - 
[FUNCTION]: Training Generator......
2022-09-29 21:36:16,167 - CRITICAL - Enable Attacker Features
2022-09-29 21:36:16,167 - CRITICAL - Disable Mean Constraint
2022-09-29 21:36:16,167 - CRITICAL - parameters['unknownVarLambda'] = 0.25
2022-09-29 21:36:16,168 - CRITICAL - Disable Confidence Rounding
2022-09-29 21:36:16,168 - CRITICAL - parameters['roundPrecision'] = 1
2022-09-29 21:36:17,581 - INFO - >>>>>>>>>>>>>>>>>
2022-09-29 21:36:17,582 - CRITICAL - In epoch 0, loss is tensor(0.0567, device='cuda:0')
2022-09-29 21:36:17,585 - INFO - L2 norm of yhat: tensor(446.7883, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-29 21:36:17,586 - INFO - L2 norm of original vector: tensor(313.6793, device='cuda:0')
2022-09-29 21:36:17,587 - INFO - First two lines of yhat: tensor([[0.6376, 0.4826, 0.6647, 0.4618, 0.3214, 0.6608, 0.4983, 0.5446, 0.2358,
         0.4483, 0.7121, 0.5926, 0.4002, 0.5089, 0.6393, 0.5587, 0.6495, 0.4594,
         0.2277, 0.6911, 0.1442, 0.3886, 0.4733, 0.3765, 0.5706, 0.5448, 0.5095,
         0.5009, 0.4241],
        [0.6667, 0.5000, 0.6807, 0.4677, 0.3468, 0.6880, 0.5166, 0.5344, 0.2333,
         0.4495, 0.7072, 0.6192, 0.4102, 0.5248, 0.6595, 0.5500, 0.6486, 0.4543,
         0.2131, 0.6932, 0.1389, 0.3892, 0.4853, 0.3673, 0.5912, 0.5408, 0.4806,
         0.4572, 0.4203]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:36:17,591 - CRITICAL - Accuracy of the original model: tensor(0.4282, device='cuda:0')
2022-09-29 21:36:34,734 - INFO - >>>>>>>>>>>>>>>>>
2022-09-29 21:36:34,735 - CRITICAL - In epoch 12, loss is tensor(0.0280, device='cuda:0')
2022-09-29 21:36:34,739 - INFO - L2 norm of yhat: tensor(616.7493, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-29 21:36:34,740 - INFO - L2 norm of original vector: tensor(288.7238, device='cuda:0')
2022-09-29 21:36:34,742 - INFO - First two lines of yhat: tensor([[0.9107, 0.9136, 0.4147, 0.0886, 0.1612, 0.9411, 0.7306, 0.3479, 0.1911,
         0.0274, 0.9591, 0.9549, 0.5582, 0.8862, 0.0723, 0.6538, 0.8921, 0.0646,
         0.0670, 0.7642, 0.0483, 0.2176, 0.4464, 0.8644, 0.6162, 0.9673, 0.2649,
         0.1648, 0.2819],
        [0.9099, 0.9232, 0.4090, 0.0879, 0.1664, 0.9393, 0.7367, 0.3374, 0.1960,
         0.0278, 0.9577, 0.9581, 0.5585, 0.8827, 0.0693, 0.6167, 0.8918, 0.0638,
         0.0623, 0.7575, 0.0446, 0.2110, 0.4473, 0.8649, 0.6125, 0.9673, 0.2666,
         0.1525, 0.2728]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:36:34,748 - CRITICAL - Accuracy of the original model: tensor(0.4282, device='cuda:0')
2022-09-29 21:36:51,622 - INFO - >>>>>>>>>>>>>>>>>
2022-09-29 21:36:51,624 - CRITICAL - In epoch 24, loss is tensor(0.0263, device='cuda:0')
2022-09-29 21:38:08,504 - INFO - L2 norm of yhat: tensor(632.3393, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-29 21:38:08,509 - INFO - L2 norm of original vector: tensor(302.5336, device='cuda:0')
2022-09-29 21:38:08,511 - INFO - First two lines of yhat: tensor([[0.7563, 0.9628, 0.1446, 0.0476, 0.1115, 0.9745, 0.6766, 0.0513, 0.2040,
         0.0111, 0.9880, 0.9855, 0.5867, 0.9491, 0.0231, 0.6671, 0.9489, 0.0287,
         0.0706, 0.8339, 0.0481, 0.0637, 0.4777, 0.9758, 0.6882, 0.9899, 0.1974,
         0.0439, 0.2165],
        [0.7544, 0.9635, 0.1456, 0.0491, 0.1103, 0.9753, 0.7094, 0.0514, 0.2062,
         0.0100, 0.9879, 0.9838, 0.5922, 0.9474, 0.0213, 0.6611, 0.9491, 0.0278,
         0.0634, 0.8224, 0.0440, 0.0670, 0.4337, 0.9749, 0.6803, 0.9901, 0.1986,
         0.0490, 0.2138]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:38:08,516 - CRITICAL - Accuracy of the original model: tensor(0.4282, device='cuda:0')
