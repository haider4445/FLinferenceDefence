2022-10-24 16:23:45,284 - CRITICAL - 


<<<<<<<-------------------------------NumOfFeaturesToRecover: 29------------------------------->>>>>>>
2022-10-24 16:23:45,290 - CRITICAL - Running on device: cuda:0
2022-10-24 16:23:45,291 - CRITICAL - Writing log to file: C:\Haider\Research\InferenceAttacksDefenses\featureinference-vfl\GRNA\log\news-2022-10-24-16-23-45-attacker-30-victim-29-mean-False-type-NN-predict-0.2.log
2022-10-24 16:23:45,292 - CRITICAL - n_attacker = 30, n_victim = 29
2022-10-24 16:23:45,303 - INFO - # By default, section names are case sensitive but keys are not
# Config parsers do not guess datatypes of values in configuration files, always storing them internally as strings. 

[DEFAULT]
DataFile = news_cleaned.csv
LogFile = news.log
NumOfFeaturesOwnedByAttacker = 30
NumOfFeaturesToRecover = 29
RunningTimes = 2

[DATASET]
TrainPortion = 0.6
TestPortion = 0.2
PredictPortion = 0.2

[DEFENCE]
EnableConfidenceRounding = False
RoundingPrecision = 1
EnablePREDVEL = 0
EnableNoising = 1
StdDevNoising = 0.1

[GENERATOR]
Epochs = 60
EnableAttackerFeatures = True  
EnableKnownMeanConstraint = False         
KnownMeanLambda = 1.2
UnknownVarLambda = 0.25

# modeltype should be one of (LR, NN, RF)
[CLASSIFIER]
ModeType = NN
# MUST SET: should be 2 for LR 
ClassNum = 5
Epochs = 60      

    

2022-10-24 16:23:45,303 - CRITICAL - 

<----------------- Running count: 1 / 2 ----------------->


2022-10-24 16:23:48,289 - CRITICAL - Dataset column permutation is: 
 tensor([47,  1, 29,  3, 24, 18, 28, 14, 33, 11, 57,  5, 13,  6, 21, 49, 10,  8,
        48, 20, 39, 26, 56,  0, 15,  2, 12,  7, 30, 25, 19, 43, 52, 16,  4, 17,
        45, 46, 44, 58, 23, 32, 55, 41, 42, 35, 38, 22, 51, 50, 40, 34, 36, 37,
        53, 31, 27,  9, 54])
2022-10-24 16:23:48,306 - CRITICAL - Creating dataset, len(samples): 39644; positive labels sum: 34720
2022-10-24 16:23:48,325 - CRITICAL - For dataset C:\Haider\Research\InferenceAttacksDefenses\featureinference-vfl\datasets\news_cleaned.csv, dataset length: 39644
2022-10-24 16:23:48,325 - CRITICAL - 
[FUNCTION]: Splitting dataset by getSplittedDataset()......
2022-10-24 16:23:48,328 - INFO - Display first (x, y) pair of dataset:
 tensor([7.6923e-01, 4.7619e-01, 5.8817e-04, 9.4664e-04, 2.7670e-04, 2.6455e-03,
        5.8817e-04, 0.0000e+00, 0.0000e+00, 4.4444e-01, 0.0000e+00, 1.2544e-03,
        1.0000e+00, 1.3158e-02, 0.0000e+00, 3.7864e-01, 5.8202e-01, 7.8125e-03,
        2.3077e-01, 2.3349e-05, 4.0853e-01, 0.0000e+00, 4.0625e-01, 1.0000e+00,
        0.0000e+00, 2.5844e-02, 0.0000e+00, 1.7241e-02, 1.0000e+00, 0.0000e+00,
        0.0000e+00, 5.2162e-01, 6.5000e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
        2.9367e-01, 7.4074e-02, 4.3359e-01, 1.8750e-01, 0.0000e+00, 0.0000e+00,
        5.0000e-01, 4.4534e-02, 4.3273e-02, 0.0000e+00, 5.3973e-01, 0.0000e+00,
        7.0000e-01, 1.0000e-01, 4.3483e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
        4.0000e-01, 0.0000e+00, 5.8817e-04, 0.0000e+00, 8.0000e-01]), tensor(0.)
2022-10-24 16:23:48,331 - INFO - Shape of (x, y): torch.Size([59]) torch.Size([])
2022-10-24 16:23:48,331 - CRITICAL - len(trainset): 23786
2022-10-24 16:23:48,335 - CRITICAL - len(testset): 7928
2022-10-24 16:23:48,342 - CRITICAL - len(predictset): 7930
2022-10-24 16:23:48,343 - INFO - len(trainloader): 372
2022-10-24 16:23:48,343 - INFO - len(testloader): 124
2022-10-24 16:23:48,343 - INFO - len(predictloader): 124
2022-10-24 16:23:48,344 - CRITICAL - 
[FUNCTION]: Creating GlobalClassifierTrainer......
2022-10-24 16:23:48,346 - CRITICAL - Creating a model for type NN
2022-10-24 16:23:49,140 - INFO - Structure of Global Classifier: GlobalPreModel_NN(
  (dense): Sequential(
    (0): Linear(in_features=59, out_features=600, bias=True)
    (1): ReLU()
    (2): Linear(in_features=600, out_features=300, bias=True)
    (3): ReLU()
    (4): Linear(in_features=300, out_features=100, bias=True)
    (5): ReLU()
    (6): Linear(in_features=100, out_features=5, bias=True)
  )
)
2022-10-24 16:23:49,140 - CRITICAL - 
[FUNCTION]: Creating GeneratorTrainer......
2022-10-24 16:23:49,141 - CRITICAL - Creating a generator
2022-10-24 16:23:49,146 - INFO - Structure of Generator: Generator(
  (net): Sequential(
    (0): Linear(in_features=59, out_features=600, bias=True)
    (1): LayerNorm((600,), eps=1e-05, elementwise_affine=True)
    (2): ReLU()
    (3): Linear(in_features=600, out_features=200, bias=True)
    (4): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
    (5): ReLU()
    (6): Linear(in_features=200, out_features=100, bias=True)
    (7): LayerNorm((100,), eps=1e-05, elementwise_affine=True)
    (8): ReLU()
    (9): Linear(in_features=100, out_features=29, bias=True)
    (10): Sigmoid()
  )
)
2022-10-24 16:23:49,146 - CRITICAL - 
[FUNCTION]: Training global classifier NN......
2022-10-24 16:23:53,972 - CRITICAL - In epoch 0, train accur is 0.42323216795921326, test accur is 0.4342835545539856.
2022-10-24 16:24:23,064 - CRITICAL - In epoch 12, train accur is 0.45694947242736816, test accur is 0.430751770734787.
2022-10-24 16:24:46,963 - CRITICAL - In epoch 24, train accur is 0.5554107427597046, test accur is 0.4093087613582611.
2022-10-24 16:25:15,726 - CRITICAL - In epoch 36, train accur is 0.7254687547683716, test accur is 0.3550706207752228.
2022-10-24 16:25:42,316 - CRITICAL - In epoch 48, train accur is 0.8433952927589417, test accur is 0.3303481340408325.
2022-10-24 16:26:08,945 - CRITICAL - In epoch 59, train accur is 0.9106617569923401, test accur is 0.33413219451904297.
2022-10-24 16:26:08,945 - CRITICAL - 
[FUNCTION]: Training Generator......
2022-10-24 16:26:08,951 - CRITICAL - Enable Attacker Features
2022-10-24 16:26:08,951 - CRITICAL - Disable Mean Constraint
2022-10-24 16:26:08,960 - CRITICAL - parameters['unknownVarLambda'] = 0.25
2022-10-24 16:26:08,960 - CRITICAL - Disable Confidence Rounding
2022-10-24 16:26:08,965 - CRITICAL - parameters['roundPrecision'] = 1
2022-10-24 16:26:12,241 - INFO - >>>>>>>>>>>>>>>>>
2022-10-24 16:26:12,245 - CRITICAL - In epoch 0, loss is tensor(40099.9453, device='cuda:0')
2022-10-24 16:26:12,281 - INFO - L2 norm of yhat: tensor(379.3853, device='cuda:0', grad_fn=<SumBackward0>)
2022-10-24 16:26:12,290 - INFO - L2 norm of original vector: tensor(332.1916, device='cuda:0')
2022-10-24 16:26:12,293 - INFO - First two lines of yhat: tensor([[0.3413, 0.4395, 0.7303, 0.3677, 0.5595, 0.4368, 0.3593, 0.6029, 0.6106,
         0.2684, 0.5428, 0.6280, 0.2544, 0.4964, 0.6382, 0.3038, 0.4736, 0.6172,
         0.7501, 0.2116, 0.3804, 0.2309, 0.4129, 0.2284, 0.5253, 0.5131, 0.1155,
         0.1581, 0.6813],
        [0.3211, 0.4935, 0.7492, 0.3617, 0.5275, 0.3984, 0.3333, 0.6198, 0.5830,
         0.2966, 0.5236, 0.6406, 0.2464, 0.5466, 0.6487, 0.3012, 0.4585, 0.6104,
         0.7104, 0.2273, 0.4016, 0.2798, 0.4058, 0.2567, 0.5387, 0.5092, 0.1158,
         0.1299, 0.6721]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-10-24 16:26:12,301 - CRITICAL - Accuracy of the original model: tensor(0.3311, device='cuda:0')
2022-10-24 16:26:12,303 - CRITICAL - Total Time Per Data Point Prediction 0.0009523226368811823
2022-10-24 16:26:49,769 - INFO - >>>>>>>>>>>>>>>>>
2022-10-24 16:26:49,773 - CRITICAL - In epoch 12, loss is tensor(17770.2578, device='cuda:0')
2022-10-24 16:26:49,779 - INFO - L2 norm of yhat: tensor(354.7324, device='cuda:0', grad_fn=<SumBackward0>)
2022-10-24 16:26:49,783 - INFO - L2 norm of original vector: tensor(350.9851, device='cuda:0')
2022-10-24 16:26:49,786 - INFO - First two lines of yhat: tensor([[0.1655, 0.4226, 0.8476, 0.1736, 0.4035, 0.2328, 0.2233, 0.2492, 0.8607,
         0.2872, 0.2408, 0.2635, 0.2179, 0.6616, 0.7167, 0.3389, 0.1675, 0.8281,
         0.5563, 0.1486, 0.5242, 0.4722, 0.0957, 0.0696, 0.6063, 0.4719, 0.0412,
         0.0516, 0.8496],
        [0.3131, 0.4718, 0.8476, 0.1146, 0.4234, 0.2481, 0.1958, 0.3534, 0.8981,
         0.2360, 0.3049, 0.4113, 0.2937, 0.6688, 0.7778, 0.3189, 0.1418, 0.7911,
         0.6674, 0.2248, 0.3803, 0.3626, 0.0786, 0.0620, 0.6455, 0.5091, 0.0467,
         0.0484, 0.8502]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-10-24 16:26:49,794 - CRITICAL - Accuracy of the original model: tensor(0.3311, device='cuda:0')
2022-10-24 16:26:49,796 - CRITICAL - Total Time Per Data Point Prediction 0.0008675858341434754
2022-10-24 16:27:22,877 - INFO - >>>>>>>>>>>>>>>>>
2022-10-24 16:27:22,881 - CRITICAL - In epoch 24, loss is tensor(16562.0449, device='cuda:0')
2022-10-24 16:27:22,888 - INFO - L2 norm of yhat: tensor(332.4914, device='cuda:0', grad_fn=<SumBackward0>)
2022-10-24 16:27:22,891 - INFO - L2 norm of original vector: tensor(345.1473, device='cuda:0')
2022-10-24 16:27:22,894 - INFO - First two lines of yhat: tensor([[0.1496, 0.4992, 0.7456, 0.0506, 0.1422, 0.2078, 0.3461, 0.1563, 0.9092,
         0.3043, 0.1853, 0.2455, 0.2489, 0.5856, 0.7096, 0.3888, 0.0672, 0.8590,
         0.4921, 0.1353, 0.3358, 0.4808, 0.1419, 0.0556, 0.4411, 0.4484, 0.0333,
         0.0341, 0.8752],
        [0.1369, 0.4840, 0.7596, 0.0573, 0.1676, 0.1929, 0.3618, 0.1681, 0.9065,
         0.3745, 0.2028, 0.2277, 0.2464, 0.5307, 0.6820, 0.3061, 0.0760, 0.8655,
         0.5540, 0.1103, 0.3633, 0.4794, 0.1897, 0.0445, 0.5137, 0.4752, 0.0330,
         0.0361, 0.8873]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-10-24 16:27:22,904 - CRITICAL - Accuracy of the original model: tensor(0.3311, device='cuda:0')
2022-10-24 16:27:22,907 - CRITICAL - Total Time Per Data Point Prediction 0.0008316398436023343
