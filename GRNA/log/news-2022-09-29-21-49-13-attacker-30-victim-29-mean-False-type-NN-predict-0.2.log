2022-09-29 21:49:13,157 - CRITICAL - 


<<<<<<<-------------------------------NumOfFeaturesToRecover: 29------------------------------->>>>>>>
2022-09-29 21:49:13,157 - CRITICAL - Running on device: cuda:0
2022-09-29 21:49:13,159 - CRITICAL - Writing log to file: C:\Haider\Research\InferenceAttacksDefenses\featureinference-vfl\GRNA\log\news-2022-09-29-21-49-13-attacker-30-victim-29-mean-False-type-NN-predict-0.2.log
2022-09-29 21:49:13,160 - CRITICAL - n_attacker = 30, n_victim = 29
2022-09-29 21:49:13,162 - INFO - # By default, section names are case sensitive but keys are not
# Config parsers do not guess datatypes of values in configuration files, always storing them internally as strings. 

[DEFAULT]
DataFile = news_cleaned.csv
LogFile = news.log
NumOfFeaturesOwnedByAttacker = 30
NumOfFeaturesToRecover = 29
RunningTimes = 2

[DATASET]
TrainPortion = 0.6
TestPortion = 0.2
PredictPortion = 0.2

[DEFENCE]
EnableConfidenceRounding = False
RoundingPrecision = 1

[GENERATOR]
Epochs = 60
EnableAttackerFeatures = True  
EnableKnownMeanConstraint = False         
KnownMeanLambda = 1.2
UnknownVarLambda = 0.25

# modeltype should be one of (LR, NN, RF)
[CLASSIFIER]
ModeType = NN
# MUST SET: should be 2 for LR 
ClassNum = 5
Epochs = 60      

    

2022-09-29 21:49:13,162 - CRITICAL - 

<----------------- Running count: 1 / 2 ----------------->


2022-09-29 21:49:15,345 - CRITICAL - Dataset column permutation is: 
 tensor([47,  1, 29,  3, 24, 18, 28, 14, 33, 11, 57,  5, 13,  6, 21, 49, 10,  8,
        48, 20, 39, 26, 56,  0, 15,  2, 12,  7, 30, 25, 19, 43, 52, 16,  4, 17,
        45, 46, 44, 58, 23, 32, 55, 41, 42, 35, 38, 22, 51, 50, 40, 34, 36, 37,
        53, 31, 27,  9, 54])
2022-09-29 21:49:15,365 - CRITICAL - Creating dataset, len(samples): 39644; positive labels sum: 34720
2022-09-29 21:49:15,389 - CRITICAL - For dataset C:\Haider\Research\InferenceAttacksDefenses\featureinference-vfl\datasets\news_cleaned.csv, dataset length: 39644
2022-09-29 21:49:15,390 - CRITICAL - 
[FUNCTION]: Splitting dataset by getSplittedDataset()......
2022-09-29 21:49:15,390 - INFO - Display first (x, y) pair of dataset:
 tensor([7.6923e-01, 4.7619e-01, 5.8817e-04, 9.4664e-04, 2.7670e-04, 2.6455e-03,
        5.8817e-04, 0.0000e+00, 0.0000e+00, 4.4444e-01, 0.0000e+00, 1.2544e-03,
        1.0000e+00, 1.3158e-02, 0.0000e+00, 3.7864e-01, 5.8202e-01, 7.8125e-03,
        2.3077e-01, 2.3349e-05, 4.0853e-01, 0.0000e+00, 4.0625e-01, 1.0000e+00,
        0.0000e+00, 2.5844e-02, 0.0000e+00, 1.7241e-02, 1.0000e+00, 0.0000e+00,
        0.0000e+00, 5.2162e-01, 6.5000e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
        2.9367e-01, 7.4074e-02, 4.3359e-01, 1.8750e-01, 0.0000e+00, 0.0000e+00,
        5.0000e-01, 4.4534e-02, 4.3273e-02, 0.0000e+00, 5.3973e-01, 0.0000e+00,
        7.0000e-01, 1.0000e-01, 4.3483e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
        4.0000e-01, 0.0000e+00, 5.8817e-04, 0.0000e+00, 8.0000e-01]), tensor(0.)
2022-09-29 21:49:15,392 - INFO - Shape of (x, y): torch.Size([59]) torch.Size([])
2022-09-29 21:49:15,395 - CRITICAL - len(trainset): 23786
2022-09-29 21:49:15,397 - CRITICAL - len(testset): 7928
2022-09-29 21:49:15,397 - CRITICAL - len(predictset): 7930
2022-09-29 21:49:15,398 - INFO - len(trainloader): 372
2022-09-29 21:49:15,398 - INFO - len(testloader): 124
2022-09-29 21:49:15,398 - INFO - len(predictloader): 124
2022-09-29 21:49:15,399 - CRITICAL - 
[FUNCTION]: Creating GlobalClassifierTrainer......
2022-09-29 21:49:15,399 - CRITICAL - Creating a model for type NN
2022-09-29 21:49:16,127 - INFO - Structure of Global Classifier: GlobalPreModel_NN(
  (dense): Sequential(
    (0): Linear(in_features=59, out_features=600, bias=True)
    (1): ReLU()
    (2): Linear(in_features=600, out_features=300, bias=True)
    (3): ReLU()
    (4): Linear(in_features=300, out_features=100, bias=True)
    (5): ReLU()
    (6): Linear(in_features=100, out_features=5, bias=True)
  )
)
2022-09-29 21:49:16,127 - CRITICAL - 
[FUNCTION]: Creating GeneratorTrainer......
2022-09-29 21:49:16,127 - CRITICAL - Creating a generator
2022-09-29 21:49:16,131 - INFO - Structure of Generator: Generator(
  (net): Sequential(
    (0): Linear(in_features=59, out_features=600, bias=True)
    (1): LayerNorm((600,), eps=1e-05, elementwise_affine=True)
    (2): ReLU()
    (3): Linear(in_features=600, out_features=200, bias=True)
    (4): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
    (5): ReLU()
    (6): Linear(in_features=200, out_features=100, bias=True)
    (7): LayerNorm((100,), eps=1e-05, elementwise_affine=True)
    (8): ReLU()
    (9): Linear(in_features=100, out_features=29, bias=True)
    (10): Sigmoid()
  )
)
2022-09-29 21:49:16,131 - CRITICAL - 
[FUNCTION]: Training global classifier NN......
2022-09-29 21:49:18,882 - CRITICAL - In epoch 0, train accur is 0.42323216795921326, test accur is 0.4342835545539856.
2022-09-29 21:49:29,734 - CRITICAL - In epoch 12, train accur is 0.45694947242736816, test accur is 0.430751770734787.
2022-09-29 21:49:40,654 - CRITICAL - In epoch 24, train accur is 0.5554107427597046, test accur is 0.4093087613582611.
2022-09-29 21:49:51,691 - CRITICAL - In epoch 36, train accur is 0.7254687547683716, test accur is 0.3550706207752228.
2022-09-29 21:50:02,749 - CRITICAL - In epoch 48, train accur is 0.8433952927589417, test accur is 0.3303481340408325.
2022-09-29 21:50:12,715 - CRITICAL - In epoch 59, train accur is 0.9106617569923401, test accur is 0.33413219451904297.
2022-09-29 21:50:12,715 - CRITICAL - 
[FUNCTION]: Training Generator......
2022-09-29 21:50:12,717 - CRITICAL - Enable Attacker Features
2022-09-29 21:50:12,717 - CRITICAL - Disable Mean Constraint
2022-09-29 21:50:12,717 - CRITICAL - parameters['unknownVarLambda'] = 0.25
2022-09-29 21:50:12,717 - CRITICAL - Disable Confidence Rounding
2022-09-29 21:50:12,717 - CRITICAL - parameters['roundPrecision'] = 1
2022-09-29 21:50:13,881 - INFO - >>>>>>>>>>>>>>>>>
2022-09-29 21:50:13,882 - CRITICAL - In epoch 0, loss is tensor(64898.8867, device='cuda:0')
2022-09-29 21:50:13,883 - INFO - L2 norm of yhat: tensor(382.8542, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-29 21:50:13,885 - INFO - L2 norm of original vector: tensor(332.1916, device='cuda:0')
2022-09-29 21:50:13,885 - INFO - First two lines of yhat: tensor([[0.4013, 0.3250, 0.6055, 0.4063, 0.4334, 0.6635, 0.3773, 0.6496, 0.4903,
         0.1886, 0.6906, 0.5321, 0.2727, 0.5967, 0.7262, 0.2844, 0.3869, 0.6288,
         0.8380, 0.2089, 0.1579, 0.1979, 0.4505, 0.1897, 0.4416, 0.5584, 0.1775,
         0.2609, 0.5979],
        [0.3923, 0.3736, 0.6443, 0.4123, 0.3926, 0.6277, 0.3311, 0.6553, 0.4745,
         0.1943, 0.6719, 0.5322, 0.2439, 0.6375, 0.7358, 0.2796, 0.3910, 0.6414,
         0.8245, 0.2279, 0.1598, 0.2379, 0.4438, 0.2018, 0.4693, 0.5513, 0.1794,
         0.2401, 0.5919]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:50:13,889 - CRITICAL - Accuracy of the original model: tensor(0.0837, device='cuda:0')
2022-09-29 21:50:27,773 - INFO - >>>>>>>>>>>>>>>>>
2022-09-29 21:50:27,774 - CRITICAL - In epoch 12, loss is tensor(26684.8301, device='cuda:0')
2022-09-29 21:50:27,776 - INFO - L2 norm of yhat: tensor(454.7595, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-29 21:50:27,777 - INFO - L2 norm of original vector: tensor(350.9851, device='cuda:0')
2022-09-29 21:50:27,777 - INFO - First two lines of yhat: tensor([[0.2036, 0.0752, 0.8735, 0.5342, 0.0616, 0.8980, 0.0953, 0.6657, 0.9010,
         0.3047, 0.7213, 0.3786, 0.0402, 0.9070, 0.6647, 0.1015, 0.5283, 0.6893,
         0.9093, 0.4338, 0.0711, 0.0865, 0.1700, 0.1349, 0.8362, 0.3783, 0.0862,
         0.1780, 0.1378],
        [0.2040, 0.0576, 0.8801, 0.5488, 0.0432, 0.9337, 0.0958, 0.7457, 0.9387,
         0.2706, 0.7637, 0.4277, 0.0317, 0.8703, 0.6937, 0.0811, 0.5050, 0.6881,
         0.9460, 0.4516, 0.0606, 0.0602, 0.2030, 0.0929, 0.8699, 0.4416, 0.0783,
         0.1944, 0.1292]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:50:27,781 - CRITICAL - Accuracy of the original model: tensor(0.0842, device='cuda:0')
2022-09-29 21:50:41,660 - INFO - >>>>>>>>>>>>>>>>>
2022-09-29 21:50:41,661 - CRITICAL - In epoch 24, loss is tensor(22985.0684, device='cuda:0')
2022-09-29 21:50:41,662 - INFO - L2 norm of yhat: tensor(518.4841, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-29 21:50:41,664 - INFO - L2 norm of original vector: tensor(345.1473, device='cuda:0')
2022-09-29 21:50:41,665 - INFO - First two lines of yhat: tensor([[0.1925, 0.0326, 0.8488, 0.7327, 0.0311, 0.9828, 0.1511, 0.8794, 0.9769,
         0.1790, 0.8514, 0.6167, 0.0173, 0.8096, 0.7983, 0.0497, 0.0941, 0.8742,
         0.9707, 0.3025, 0.0253, 0.0233, 0.2548, 0.0361, 0.7000, 0.5902, 0.1427,
         0.3097, 0.0697],
        [0.3502, 0.0357, 0.8714, 0.5941, 0.0673, 0.9779, 0.2321, 0.7577, 0.9720,
         0.1292, 0.8553, 0.8370, 0.0201, 0.9525, 0.7127, 0.0553, 0.3346, 0.6779,
         0.9210, 0.2233, 0.0877, 0.0419, 0.2014, 0.0689, 0.8834, 0.2176, 0.0935,
         0.1737, 0.0783]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:50:41,668 - CRITICAL - Accuracy of the original model: tensor(0.0831, device='cuda:0')
2022-09-29 21:50:55,560 - INFO - >>>>>>>>>>>>>>>>>
2022-09-29 21:50:55,561 - CRITICAL - In epoch 36, loss is tensor(21484.9473, device='cuda:0')
2022-09-29 21:50:55,563 - INFO - L2 norm of yhat: tensor(544.7204, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-29 21:50:55,564 - INFO - L2 norm of original vector: tensor(345.1501, device='cuda:0')
2022-09-29 21:50:55,565 - INFO - First two lines of yhat: tensor([[0.3096, 0.0198, 0.9647, 0.4988, 0.0287, 0.9895, 0.1178, 0.8655, 0.9714,
         0.3500, 0.7769, 0.4534, 0.0122, 0.9615, 0.6564, 0.0408, 0.5955, 0.8763,
         0.9057, 0.5822, 0.0280, 0.0681, 0.1811, 0.1102, 0.9878, 0.3032, 0.1330,
         0.2233, 0.0798],
        [0.3489, 0.0351, 0.9621, 0.7655, 0.0442, 0.9872, 0.1752, 0.9397, 0.9793,
         0.2818, 0.8453, 0.8487, 0.0077, 0.9630, 0.7007, 0.0210, 0.3177, 0.7771,
         0.9645, 0.4467, 0.0370, 0.0328, 0.1404, 0.0539, 0.9666, 0.3063, 0.0900,
         0.1157, 0.0323]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:50:55,571 - CRITICAL - Accuracy of the original model: tensor(0.0834, device='cuda:0')
2022-09-29 21:51:09,479 - INFO - >>>>>>>>>>>>>>>>>
2022-09-29 21:51:09,480 - CRITICAL - In epoch 48, loss is tensor(20340.7012, device='cuda:0')
2022-09-29 21:51:09,482 - INFO - L2 norm of yhat: tensor(538.5705, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-29 21:51:09,483 - INFO - L2 norm of original vector: tensor(332.1738, device='cuda:0')
2022-09-29 21:51:09,484 - INFO - First two lines of yhat: tensor([[0.3795, 0.0062, 0.9641, 0.1636, 0.0323, 0.9816, 0.0627, 0.7867, 0.9544,
         0.3188, 0.7580, 0.5999, 0.0053, 0.9924, 0.5493, 0.1929, 0.5732, 0.8866,
         0.7403, 0.3339, 0.0550, 0.0321, 0.1201, 0.3000, 0.9877, 0.0969, 0.1266,
         0.2498, 0.0918],
        [0.4225, 0.0187, 0.9679, 0.3602, 0.0648, 0.9881, 0.2293, 0.7984, 0.9809,
         0.3844, 0.7022, 0.8653, 0.0058, 0.9923, 0.5558, 0.1315, 0.5612, 0.8032,
         0.8163, 0.3628, 0.1095, 0.0435, 0.1384, 0.2880, 0.9863, 0.0609, 0.1213,
         0.1073, 0.0971]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:51:09,488 - CRITICAL - Accuracy of the original model: tensor(0.0840, device='cuda:0')
2022-09-29 21:51:22,599 - INFO - >>>>>>>>>>>>>>>>>
2022-09-29 21:51:22,600 - CRITICAL - In epoch 59, loss is tensor(19611.1016, device='cuda:0')
2022-09-29 21:51:22,602 - INFO - L2 norm of yhat: tensor(538.0852, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-29 21:51:22,603 - INFO - L2 norm of original vector: tensor(336.7561, device='cuda:0')
2022-09-29 21:51:22,604 - INFO - First two lines of yhat: tensor([[0.2894, 0.0320, 0.9469, 0.8901, 0.0965, 0.9958, 0.3040, 0.8829, 0.9927,
         0.2721, 0.7407, 0.8556, 0.0074, 0.9779, 0.5049, 0.0144, 0.4004, 0.8192,
         0.9672, 0.4823, 0.0470, 0.0537, 0.3952, 0.0908, 0.9858, 0.1159, 0.1126,
         0.1240, 0.0352],
        [0.6543, 0.0363, 0.8564, 0.2915, 0.0510, 0.9892, 0.5169, 0.4238, 0.9766,
         0.2636, 0.4702, 0.6099, 0.0134, 0.9920, 0.5156, 0.2716, 0.6436, 0.6405,
         0.6628, 0.4316, 0.0837, 0.1637, 0.2975, 0.4584, 0.9853, 0.0623, 0.3261,
         0.2548, 0.2407]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:51:22,608 - CRITICAL - Accuracy of the original model: tensor(0.0835, device='cuda:0')
2022-09-29 21:51:22,610 - CRITICAL - 
[FUNCTION]: Testing Generator......
2022-09-29 21:51:22,611 - CRITICAL - Enable Attacker Features
2022-09-29 21:51:22,611 - CRITICAL - Disable Mean Constraint
2022-09-29 21:51:22,707 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-29 21:51:22,707 - CRITICAL - Model output loss: 0.21878264844417572
2022-09-29 21:51:22,709 - CRITICAL - Random guess loss: 0.2562767565250397
2022-09-29 21:51:22,709 - INFO - Model output loss PF: [0.12014879 0.17973188 0.05980403 0.32819378 0.00489408 0.76305795
 0.04218093 0.41631007 0.27636528 0.09119924 0.28385672 0.40713316
 0.146979   0.63613629 0.28535742 0.05300435 0.19296873 0.11141251
 0.08029792 0.08137369 0.16451222 0.10475966 0.14391568 0.14236613
 0.28429526 0.19806434 0.0226662  0.05607126 0.66764033]
2022-09-29 21:51:22,710 - INFO - Random guess loss PF: [0.32745725 0.09155503 0.17569184 0.34495872 0.32075244 0.36658862
 0.1677202  0.26817197 0.08320457 0.29502538 0.11927434 0.34349677
 0.22438622 0.19753665 0.24663363 0.30813891 0.22256437 0.2853269
 0.213291   0.23334426 0.27543747 0.3063556  0.32265833 0.3418659
 0.18155496 0.3337     0.26390964 0.30701733 0.26440749]
2022-09-29 21:51:22,710 - INFO - Attack result, first 2 samples: tensor([[0.5680, 0.0085, 0.9379, 0.1299, 0.0305, 0.9900, 0.1414, 0.5904, 0.9566,
         0.3078, 0.6473, 0.4760, 0.0098, 0.9954, 0.7177, 0.3560, 0.7481, 0.6846,
         0.6309, 0.5365, 0.0551, 0.1006, 0.1320, 0.4834, 0.9944, 0.1122, 0.2741,
         0.2600, 0.2347],
        [0.1068, 0.0460, 0.6092, 0.9650, 0.0226, 0.9938, 0.1822, 0.5310, 0.9856,
         0.5596, 0.8565, 0.3432, 0.0073, 0.9464, 0.8943, 0.0159, 0.1620, 0.8340,
         0.9933, 0.3983, 0.0060, 0.0239, 0.3778, 0.0291, 0.7167, 0.4124, 0.2140,
         0.1426, 0.0898]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:51:22,717 - INFO - Ground truth, first 2 samples: tensor([[2.0710e-03, 4.5868e-01, 8.7222e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         2.7023e-01, 4.5440e-02, 6.3495e-01, 1.0000e-01, 3.2181e-01, 0.0000e+00,
         2.0000e-01, 2.9887e-01, 4.3171e-02, 0.0000e+00, 2.5872e-01, 1.0000e+00,
         1.0000e+00, 1.0000e-01, 4.3479e-02, 0.0000e+00, 1.0000e+00, 1.0000e+00,
         8.4444e-01, 0.0000e+00, 7.4707e-03, 2.1978e-02, 9.0000e-01],
        [1.5114e-03, 4.0294e-01, 7.2028e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         2.9094e-01, 9.6561e-02, 4.6288e-01, 0.0000e+00, 2.7982e-01, 0.0000e+00,
         0.0000e+00, 5.4202e-02, 5.3927e-02, 0.0000e+00, 8.6250e-01, 1.0000e+00,
         1.0000e+00, 3.3333e-02, 5.4561e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         5.0000e-01, 0.0000e+00, 6.1070e-04, 1.0989e-01, 8.7500e-01]],
       device='cuda:0'):
2022-09-29 21:51:22,733 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-29 21:51:22,734 - CRITICAL - Model output loss: 0.22022822499275208
2022-09-29 21:51:22,734 - CRITICAL - Random guess loss: 0.252722829580307
2022-09-29 21:51:22,734 - INFO - Model output loss PF: [0.12786636 0.18778402 0.04210233 0.34777513 0.00738323 0.85506994
 0.045881   0.39861444 0.2787478  0.09764531 0.23985484 0.44639581
 0.19543417 0.57862246 0.27871937 0.05764151 0.22031319 0.07881319
 0.07881007 0.10274023 0.07718951 0.16086398 0.10060178 0.13965249
 0.325881   0.18035215 0.02242956 0.04982921 0.66360486]
2022-09-29 21:51:22,735 - INFO - Random guess loss PF: [0.2827127  0.09506399 0.16595688 0.34646186 0.33699965 0.32158205
 0.16130134 0.23754664 0.07182784 0.20254087 0.11405337 0.27284035
 0.20509697 0.20726141 0.2436139  0.34575051 0.24608237 0.27121773
 0.287016   0.27321059 0.20625807 0.32534558 0.36084569 0.30480662
 0.20754156 0.30112243 0.29278195 0.39160833 0.25051475]
2022-09-29 21:51:22,735 - INFO - Attack result, first 2 samples: tensor([[0.3215, 0.0072, 0.9472, 0.4198, 0.0709, 0.9918, 0.0996, 0.8013, 0.9875,
         0.2273, 0.8145, 0.8957, 0.0027, 0.9963, 0.6425, 0.0536, 0.4820, 0.7594,
         0.9061, 0.2122, 0.0660, 0.0169, 0.1820, 0.2638, 0.9873, 0.0468, 0.0675,
         0.1348, 0.0551],
        [0.3937, 0.0237, 0.6575, 0.2873, 0.0431, 0.9847, 0.3784, 0.1871, 0.9570,
         0.2000, 0.6012, 0.7197, 0.0057, 0.9962, 0.7435, 0.2990, 0.6627, 0.4656,
         0.7338, 0.3104, 0.0684, 0.0679, 0.3493, 0.4561, 0.9645, 0.0332, 0.2161,
         0.2128, 0.1495]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:51:22,739 - INFO - Ground truth, first 2 samples: tensor([[1.9403e-03, 2.8879e-01, 8.3556e-01, 0.0000e+00, 9.5969e-04, 1.0000e+00,
         2.4118e-01, 1.1265e-01, 4.0699e-01, 0.0000e+00, 2.9391e-01, 0.0000e+00,
         0.0000e+00, 3.0837e-02, 3.0894e-02, 0.0000e+00, 3.0822e-02, 1.0000e+00,
         7.5000e-01, 5.0000e-02, 9.6265e-01, 1.0000e+00, 0.0000e+00, 0.0000e+00,
         7.0000e-01, 0.0000e+00, 1.1194e-03, 0.0000e+00, 9.0000e-01],
        [2.6240e-03, 4.5096e-01, 7.6435e-01, 1.0000e+00, 9.5969e-04, 0.0000e+00,
         1.7434e-01, 1.9545e-01, 3.6020e-01, 1.6667e-01, 5.9836e-01, 0.0000e+00,
         6.6667e-02, 7.1954e-02, 4.3146e-01, 0.0000e+00, 4.3144e-01, 1.0000e+00,
         6.0000e-01, 5.0000e-02, 7.2470e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         5.0000e-01, 1.0000e+00, 1.7787e-03, 0.0000e+00, 9.5000e-01]],
       device='cuda:0'):
2022-09-29 21:51:22,752 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-29 21:51:22,752 - CRITICAL - Model output loss: 0.22149652242660522
2022-09-29 21:51:22,752 - CRITICAL - Random guess loss: 0.2609075903892517
2022-09-29 21:51:22,753 - INFO - Model output loss PF: [0.12486631 0.19385225 0.05103247 0.30614781 0.00437942 0.73365986
 0.04685365 0.4241206  0.28671491 0.08388194 0.26683819 0.42147109
 0.15184358 0.65854478 0.25377071 0.09132795 0.232081   0.10702624
 0.09759387 0.09866359 0.15650165 0.15116091 0.08998983 0.12470679
 0.35073054 0.16028643 0.02168899 0.04601566 0.6876483 ]
2022-09-29 21:51:22,753 - INFO - Random guess loss PF: [0.31476814 0.09859429 0.19277149 0.36901805 0.35429615 0.35513109
 0.18168758 0.27472737 0.10811672 0.271238   0.13185063 0.35902727
 0.2431629  0.22052391 0.19191167 0.35989553 0.23076449 0.24371663
 0.2111074  0.26233956 0.24207237 0.28249776 0.31888527 0.30351722
 0.19736159 0.37084836 0.30129421 0.32828581 0.24690869]
2022-09-29 21:51:22,753 - INFO - Attack result, first 2 samples: tensor([[0.6222, 0.1989, 0.8809, 0.8772, 0.0431, 0.9970, 0.4274, 0.9441, 0.9919,
         0.2646, 0.7385, 0.7879, 0.0291, 0.8623, 0.7481, 0.0160, 0.0913, 0.9137,
         0.9868, 0.4214, 0.0316, 0.0405, 0.3882, 0.0135, 0.7416, 0.3865, 0.4624,
         0.2225, 0.0758],
        [0.2370, 0.0041, 0.9710, 0.3244, 0.0340, 0.9899, 0.0430, 0.8171, 0.9811,
         0.2629, 0.7966, 0.6893, 0.0023, 0.9955, 0.5314, 0.0576, 0.5290, 0.8821,
         0.8748, 0.3583, 0.0246, 0.0192, 0.0993, 0.2823, 0.9932, 0.0951, 0.0614,
         0.2148, 0.0393]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:51:22,760 - INFO - Ground truth, first 2 samples: tensor([[2.9792e-03, 4.7971e-01, 6.4698e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         3.5753e-01, 8.0395e-02, 4.9552e-01, 5.0000e-01, 2.1562e-01, 1.0000e+00,
         5.0000e-01, 1.7822e-01, 2.9409e-01, 0.0000e+00, 4.4876e-01, 1.0000e+00,
         1.0000e+00, 3.3333e-02, 2.1765e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         1.2500e-01, 0.0000e+00, 1.7787e-03, 1.0989e-02, 9.5000e-01],
        [4.3231e-04, 3.4421e-01, 6.9861e-01, 0.0000e+00, 9.5969e-04, 1.0000e+00,
         1.7877e-01, 9.0186e-02, 3.9063e-01, 0.0000e+00, 1.8509e-01, 0.0000e+00,
         0.0000e+00, 3.1572e-01, 2.1579e-02, 0.0000e+00, 2.1582e-02, 1.0000e+00,
         1.0000e+00, 6.2500e-02, 7.0375e-01, 1.0000e+00, 0.0000e+00, 0.0000e+00,
         2.5000e-01, 0.0000e+00, 0.0000e+00, 0.0000e+00, 9.5000e-01]],
       device='cuda:0'):
2022-09-29 21:51:22,777 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-29 21:51:22,777 - CRITICAL - Model output loss: 0.2229073941707611
2022-09-29 21:51:22,777 - CRITICAL - Random guess loss: 0.2583594024181366
2022-09-29 21:51:22,777 - INFO - Model output loss PF: [0.10962816 0.18373993 0.05755333 0.3061561  0.00425353 0.71641576
 0.04461954 0.39085495 0.28646955 0.08488983 0.28467184 0.4022339
 0.10744216 0.67999285 0.32178599 0.09184222 0.24256933 0.0961039
 0.10080737 0.08201873 0.15303612 0.18276308 0.10058248 0.16437411
 0.31741607 0.189427   0.01580737 0.05066339 0.69619536]
2022-09-29 21:51:22,778 - INFO - Random guess loss PF: [0.37155432 0.10378184 0.13885358 0.29193583 0.3527385  0.33388075
 0.16181368 0.27152446 0.09543957 0.25517416 0.11676842 0.29055303
 0.21580428 0.25950503 0.25167483 0.33322573 0.22342849 0.33920357
 0.25045371 0.25903714 0.22436765 0.31515265 0.33818692 0.26007226
 0.19436958 0.38263592 0.32952917 0.30550262 0.22625487]
2022-09-29 21:51:22,778 - INFO - Attack result, first 2 samples: tensor([[0.2693, 0.0054, 0.9511, 0.2676, 0.0443, 0.9926, 0.0557, 0.8322, 0.9856,
         0.1803, 0.8465, 0.7611, 0.0019, 0.9953, 0.6248, 0.0454, 0.5509, 0.8239,
         0.9284, 0.2648, 0.0277, 0.0165, 0.1635, 0.2148, 0.9862, 0.0832, 0.0557,
         0.2445, 0.0368],
        [0.2573, 0.0041, 0.9290, 0.1581, 0.0145, 0.9884, 0.0637, 0.4832, 0.9732,
         0.2195, 0.7391, 0.3119, 0.0040, 0.9960, 0.7079, 0.1046, 0.7455, 0.8430,
         0.7906, 0.4801, 0.0159, 0.0421, 0.0980, 0.2697, 0.9941, 0.1810, 0.0878,
         0.2850, 0.0849]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:51:22,784 - INFO - Ground truth, first 2 samples: tensor([[9.0483e-03, 3.1326e-01, 7.0461e-01, 1.0000e+00, 9.5969e-04, 0.0000e+00,
         1.6925e-01, 1.0349e-01, 3.9523e-01, 0.0000e+00, 1.7732e-01, 0.0000e+00,
         0.0000e+00, 2.1590e-02, 7.0639e-01, 0.0000e+00, 2.0129e-01, 1.0000e+00,
         1.0000e+00, 1.0000e-01, 1.2874e-01, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         6.0000e-01, 1.0000e+00, 0.0000e+00, 0.0000e+00, 9.2857e-01],
        [1.9471e-03, 5.9271e-01, 6.7378e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         2.9930e-01, 1.4045e-01, 4.8214e-01, 4.3333e-01, 2.2592e-01, 0.0000e+00,
         6.0000e-01, 4.3669e-01, 3.5952e-02, 0.0000e+00, 3.5961e-02, 1.0000e+00,
         1.0000e+00, 1.0000e-01, 3.6451e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 1.0000e+00, 9.6051e-03, 1.0989e-02, 9.5000e-01]],
       device='cuda:0'):
2022-09-29 21:51:22,801 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-29 21:51:22,801 - CRITICAL - Model output loss: 0.21933721005916595
2022-09-29 21:51:22,803 - CRITICAL - Random guess loss: 0.251625120639801
2022-09-29 21:51:22,803 - INFO - Model output loss PF: [0.10390668 0.18489532 0.03589826 0.37215129 0.00672462 0.82346725
 0.04383943 0.44730777 0.26785827 0.12515981 0.26779822 0.45948675
 0.18698955 0.65209526 0.2762199  0.05221126 0.20837207 0.07546189
 0.10910566 0.09567305 0.09206472 0.16477197 0.07778562 0.11304837
 0.24726027 0.1334295  0.01507371 0.04268241 0.6800403 ]
2022-09-29 21:51:22,804 - INFO - Random guess loss PF: [0.39067671 0.09950782 0.18905714 0.35463381 0.31445292 0.33915663
 0.15546244 0.30158973 0.10466923 0.30921826 0.15168124 0.2830888
 0.26332143 0.18012184 0.26353031 0.25253874 0.2418807  0.30171186
 0.2093038  0.22898924 0.21109648 0.27663326 0.30957872 0.24956253
 0.18296579 0.31603229 0.31045365 0.27989981 0.22631386]
2022-09-29 21:51:22,804 - INFO - Attack result, first 2 samples: tensor([[0.2828, 0.0123, 0.8784, 0.1297, 0.0390, 0.9718, 0.1140, 0.4005, 0.9754,
         0.0719, 0.8203, 0.6384, 0.0068, 0.9896, 0.7942, 0.1469, 0.7059, 0.7745,
         0.8837, 0.4229, 0.0423, 0.0474, 0.2776, 0.3362, 0.9918, 0.1873, 0.0969,
         0.2067, 0.1579],
        [0.2840, 0.0091, 0.8806, 0.1525, 0.0316, 0.9721, 0.0401, 0.7485, 0.9702,
         0.0507, 0.8415, 0.6972, 0.0068, 0.9827, 0.5959, 0.1057, 0.4911, 0.9165,
         0.9051, 0.2415, 0.0540, 0.0211, 0.3803, 0.3578, 0.9587, 0.1879, 0.0938,
         0.2364, 0.0993]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:51:22,810 - INFO - Ground truth, first 2 samples: tensor([[1.9303e-03, 5.1174e-01, 6.5484e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         4.4518e-01, 2.1502e-01, 4.5258e-01, 3.6667e-01, 1.6819e-01, 0.0000e+00,
         5.6667e-01, 2.4058e-02, 3.2991e-01, 0.0000e+00, 2.3991e-02, 1.0000e+00,
         1.0000e+00, 5.0000e-02, 2.6785e-01, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 0.0000e+00, 8.5142e-04, 0.0000e+00, 9.5000e-01],
        [3.0965e-03, 4.1399e-01, 6.2667e-01, 1.0000e+00, 9.5969e-04, 0.0000e+00,
         1.8883e-01, 4.6696e-02, 4.1060e-01, 6.0000e-01, 3.4831e-01, 0.0000e+00,
         1.0000e+00, 2.1637e-02, 3.5073e-01, 0.0000e+00, 4.7572e-01, 1.0000e+00,
         5.0000e-01, 5.0000e-02, 2.1062e-01, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         2.0000e-01, 0.0000e+00, 9.0241e-04, 0.0000e+00, 8.3333e-01]],
       device='cuda:0'):
2022-09-29 21:51:22,826 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-29 21:51:22,827 - CRITICAL - Model output loss: 0.21966485679149628
2022-09-29 21:51:22,827 - CRITICAL - Random guess loss: 0.25140437483787537
2022-09-29 21:51:22,827 - INFO - Model output loss PF: [0.11194988 0.21084411 0.0471308  0.35921565 0.00433646 0.77663678
 0.06032353 0.45737773 0.26714823 0.07428151 0.34063798 0.40691131
 0.17798889 0.6946491  0.27239954 0.02049091 0.19408506 0.11375502
 0.07274942 0.08479279 0.11082952 0.13614713 0.11821309 0.10647381
 0.28138411 0.1189207  0.01975127 0.05594908 0.67490721]
2022-09-29 21:51:22,828 - INFO - Random guess loss PF: [0.34818271 0.08331166 0.1787743  0.34005031 0.26639575 0.34005225
 0.14343889 0.29490852 0.09153631 0.2903533  0.15729228 0.2856189
 0.21352443 0.30952018 0.20024973 0.319965   0.25510147 0.23987205
 0.24485764 0.21139961 0.22850904 0.3109442  0.29117599 0.33769843
 0.15705919 0.30330673 0.32805267 0.30470356 0.21487169]
2022-09-29 21:51:22,828 - INFO - Attack result, first 2 samples: tensor([[0.2938, 0.0061, 0.8612, 0.1480, 0.0236, 0.9762, 0.0687, 0.3374, 0.9692,
         0.1310, 0.7927, 0.5249, 0.0046, 0.9943, 0.7919, 0.2144, 0.7175, 0.6966,
         0.8257, 0.3996, 0.0384, 0.0291, 0.1280, 0.3675, 0.9913, 0.1480, 0.1302,
         0.2010, 0.1537],
        [0.2811, 0.0035, 0.9719, 0.1389, 0.0226, 0.9899, 0.0362, 0.7541, 0.9725,
         0.3537, 0.7774, 0.4324, 0.0038, 0.9953, 0.6343, 0.1350, 0.7107, 0.8769,
         0.7485, 0.4886, 0.0283, 0.0338, 0.0658, 0.3611, 0.9957, 0.1546, 0.1004,
         0.2288, 0.0958]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:51:22,835 - INFO - Ground truth, first 2 samples: tensor([[1.6622e-03, 6.2386e-01, 5.2564e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         2.3558e-01, 2.5750e-01, 2.5341e-01, 5.0000e-01, 1.8445e-01, 0.0000e+00,
         1.0000e+00, 2.7028e-02, 1.5931e-01, 0.0000e+00, 2.7035e-02, 1.0000e+00,
         1.0000e+00, 5.0000e-02, 2.7199e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         2.0000e-01, 0.0000e+00, 1.5416e-03, 1.0989e-02, 8.3333e-01],
        [3.2775e-03, 3.9935e-01, 8.1786e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         3.6187e-01, 5.5319e-02, 4.4713e-01, 0.0000e+00, 1.7298e-01, 1.0000e+00,
         0.0000e+00, 3.5712e-01, 2.4158e-02, 0.0000e+00, 2.1704e-01, 1.0000e+00,
         7.0000e-01, 3.3333e-02, 2.4212e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         6.0000e-01, 0.0000e+00, 6.6169e-04, 1.0989e-02, 9.5000e-01]],
       device='cuda:0'):
2022-09-29 21:51:22,851 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-29 21:51:22,851 - CRITICAL - Model output loss: 0.21966375410556793
2022-09-29 21:51:22,851 - CRITICAL - Random guess loss: 0.2575789988040924
2022-09-29 21:51:22,852 - INFO - Model output loss PF: [0.11698785 0.20364492 0.04185849 0.32310137 0.00678023 0.76256752
 0.04832213 0.39020526 0.27342057 0.09734292 0.26817837 0.42531887
 0.15426721 0.66588247 0.2932401  0.02690028 0.22806332 0.117512
 0.05762024 0.09418772 0.11675422 0.1445     0.15401985 0.11537324
 0.33564603 0.17853838 0.01558429 0.04347741 0.67095339]
2022-09-29 21:51:22,852 - INFO - Random guess loss PF: [0.32968682 0.08501402 0.14992799 0.33533975 0.32935044 0.30697247
 0.15336913 0.22590561 0.09087331 0.26180625 0.18059884 0.33184445
 0.24884695 0.22528173 0.2955004  0.31940275 0.20639291 0.29152822
 0.20840016 0.24551082 0.26257771 0.35136265 0.35110915 0.32753718
 0.19251533 0.31395775 0.30834952 0.34652483 0.19430375]
2022-09-29 21:51:22,852 - INFO - Attack result, first 2 samples: tensor([[0.2933, 0.0038, 0.9723, 0.3414, 0.0551, 0.9897, 0.0351, 0.9148, 0.9777,
         0.2576, 0.8353, 0.7628, 0.0032, 0.9928, 0.4797, 0.0589, 0.5357, 0.8580,
         0.9002, 0.2725, 0.0413, 0.0140, 0.1480, 0.3201, 0.9870, 0.1218, 0.0734,
         0.2087, 0.0660],
        [0.2197, 0.0036, 0.8341, 0.5977, 0.0151, 0.9847, 0.0537, 0.5078, 0.9908,
         0.1145, 0.8600, 0.6170, 0.0015, 0.9955, 0.7397, 0.0289, 0.6931, 0.7235,
         0.9687, 0.2953, 0.0164, 0.0071, 0.1873, 0.1522, 0.9888, 0.1046, 0.0631,
         0.2607, 0.0385]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:51:22,859 - INFO - Ground truth, first 2 samples: tensor([[3.6863e-03, 4.1304e-01, 6.0000e-01, 1.0000e+00, 9.5969e-04, 0.0000e+00,
         2.8711e-01, 1.6093e-02, 5.0914e-01, 0.0000e+00, 1.0687e-01, 0.0000e+00,
         0.0000e+00, 2.1590e-02, 5.6389e-01, 0.0000e+00, 2.1611e-02, 8.1869e-01,
         7.0000e-01, 1.3636e-01, 4.5340e-01, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         6.0000e-01, 1.0000e+00, 0.0000e+00, 0.0000e+00, 6.0000e-01],
        [3.6863e-03, 4.8699e-01, 6.9833e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         3.1019e-01, 8.6936e-02, 5.2484e-01, 2.0000e-01, 4.0563e-01, 0.0000e+00,
         3.0000e-01, 3.0838e-02, 3.0876e-02, 0.0000e+00, 9.5540e-01, 1.0000e+00,
         1.0000e+00, 1.0000e-01, 3.1057e-02, 0.0000e+00, 1.0000e+00, 1.0000e+00,
         0.0000e+00, 0.0000e+00, 2.1345e-03, 0.0000e+00, 9.0000e-01]],
       device='cuda:0'):
2022-09-29 21:51:22,875 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-29 21:51:22,875 - CRITICAL - Model output loss: 0.2312684804201126
2022-09-29 21:51:22,878 - CRITICAL - Random guess loss: 0.26277273893356323
2022-09-29 21:51:22,878 - INFO - Model output loss PF: [0.12422238 0.18789887 0.04392126 0.35527337 0.00512205 0.73391891
 0.05590958 0.4500879  0.27343565 0.08942342 0.32291344 0.42877907
 0.26348016 0.66893947 0.28367212 0.03748294 0.18442979 0.12829897
 0.10812332 0.09415352 0.15070695 0.12765151 0.10952432 0.1321473
 0.31818497 0.25448889 0.01971625 0.04864026 0.7062394 ]
2022-09-29 21:51:22,879 - INFO - Random guess loss PF: [0.33494329 0.11958686 0.12682605 0.39497626 0.32342404 0.40636864
 0.14634302 0.26246697 0.10187381 0.23747532 0.18069242 0.30183291
 0.26163408 0.20052589 0.21250372 0.30355245 0.18238768 0.28334922
 0.19313897 0.25547391 0.22887158 0.35360047 0.368624   0.34901226
 0.18167859 0.35793421 0.32985803 0.37263954 0.24881522]
2022-09-29 21:51:22,879 - INFO - Attack result, first 2 samples: tensor([[0.2553, 0.0200, 0.9669, 0.8494, 0.0907, 0.9957, 0.2203, 0.8833, 0.9891,
         0.3228, 0.7186, 0.8129, 0.0047, 0.9854, 0.4982, 0.0177, 0.3694, 0.8583,
         0.9272, 0.4697, 0.0270, 0.0464, 0.2336, 0.1319, 0.9898, 0.1093, 0.0850,
         0.1249, 0.0309],
        [0.2392, 0.0103, 0.9426, 0.7180, 0.0248, 0.9953, 0.0517, 0.9532, 0.9863,
         0.3608, 0.8602, 0.6947, 0.0061, 0.9819, 0.5889, 0.0192, 0.1921, 0.9297,
         0.9670, 0.3106, 0.0173, 0.0114, 0.1237, 0.0897, 0.9645, 0.2388, 0.1418,
         0.1428, 0.0359]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:51:22,885 - INFO - Ground truth, first 2 samples: tensor([[5.6971e-03, 4.8182e-01, 5.6057e-01, 0.0000e+00, 9.5969e-04, 1.0000e+00,
         2.2446e-01, 1.3949e-01, 3.4505e-01, 7.1429e-01, 2.0484e-01, 0.0000e+00,
         8.5714e-01, 2.1586e-02, 2.2236e-01, 0.0000e+00, 2.1576e-02, 1.0000e+00,
         1.0000e+00, 1.0000e-01, 7.9764e-01, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         0.0000e+00, 0.0000e+00, 0.0000e+00, 0.0000e+00, 9.5000e-01],
        [3.3512e-03, 5.7038e-01, 7.7854e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         4.1383e-01, 1.0267e-01, 5.7703e-01, 0.0000e+00, 1.0102e-01, 0.0000e+00,
         0.0000e+00, 4.0798e-01, 6.0568e-01, 1.0000e+00, 2.1991e-02, 8.1869e-01,
         1.0000e+00, 1.0000e-01, 2.1752e-02, 0.0000e+00, 0.0000e+00, 1.0000e+00,
         4.0000e-01, 0.0000e+00, 1.4230e-03, 0.0000e+00, 9.5000e-01]],
       device='cuda:0'):
2022-09-29 21:51:22,902 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-29 21:51:22,902 - CRITICAL - Model output loss: 0.22328932583332062
2022-09-29 21:51:22,902 - CRITICAL - Random guess loss: 0.256510466337204
2022-09-29 21:51:22,902 - INFO - Model output loss PF: [0.13683116 0.18250281 0.04907665 0.29081014 0.00852804 0.7619313
 0.06486979 0.36637515 0.29892293 0.08045232 0.21110655 0.47740251
 0.17574826 0.66112125 0.30688137 0.06135991 0.23425806 0.07629281
 0.12032223 0.09881764 0.11050659 0.13045241 0.16151808 0.1692034
 0.34602791 0.17293401 0.02610139 0.04687581 0.64816034]
2022-09-29 21:51:22,903 - INFO - Random guess loss PF: [0.30341339 0.11837313 0.15458435 0.31996387 0.31110615 0.35171038
 0.16939756 0.27154857 0.10878712 0.255395   0.10920607 0.36263829
 0.25815523 0.22299272 0.20024148 0.33946607 0.2255858  0.28753972
 0.17309302 0.23646538 0.19136444 0.33551365 0.27928606 0.33637482
 0.21073705 0.34904608 0.36925656 0.35805809 0.22950351]
2022-09-29 21:51:22,903 - INFO - Attack result, first 2 samples: tensor([[0.2479, 0.0034, 0.9519, 0.1742, 0.0173, 0.9892, 0.0313, 0.7362, 0.9753,
         0.2263, 0.7486, 0.2983, 0.0045, 0.9945, 0.6189, 0.0702, 0.6951, 0.8848,
         0.8174, 0.4254, 0.0151, 0.0318, 0.1125, 0.3309, 0.9928, 0.1988, 0.0908,
         0.3064, 0.0854],
        [0.1962, 0.0098, 0.5418, 0.6721, 0.0329, 0.9763, 0.1934, 0.1182, 0.9772,
         0.1849, 0.7259, 0.7551, 0.0038, 0.9955, 0.7410, 0.1328, 0.5705, 0.5066,
         0.8902, 0.3650, 0.0415, 0.0207, 0.3094, 0.4278, 0.9730, 0.0568, 0.1543,
         0.2442, 0.0714]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:51:22,909 - INFO - Ground truth, first 2 samples: tensor([[2.3995e-03, 4.6896e-01, 8.2282e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         2.9880e-01, 7.1780e-02, 5.1186e-01, 4.0000e-01, 3.3748e-01, 0.0000e+00,
         3.5000e-01, 1.5949e-01, 2.1778e-02, 0.0000e+00, 3.8361e-01, 1.0000e+00,
         8.5000e-01, 3.3333e-02, 1.4800e-01, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         7.0833e-01, 0.0000e+00, 1.3044e-03, 0.0000e+00, 9.2857e-01],
        [0.0000e+00, 4.3988e-01, 6.9094e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         9.9381e-02, 1.3727e-01, 3.0662e-01, 0.0000e+00, 4.5467e-01, 0.0000e+00,
         0.0000e+00, 5.3968e-02, 5.3929e-02, 0.0000e+00, 8.6299e-01, 1.0000e+00,
         8.0000e-01, 5.0000e-02, 5.4352e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         4.0000e-01, 1.0000e+00, 4.6958e-04, 0.0000e+00, 9.0000e-01]],
       device='cuda:0'):
2022-09-29 21:51:22,927 - CRITICAL - <<<<<<<<<<<<<<<<
2022-09-29 21:51:22,927 - CRITICAL - Model output loss: 0.2271583527326584
2022-09-29 21:51:22,929 - CRITICAL - Random guess loss: 0.27311742305755615
2022-09-29 21:51:22,929 - INFO - Model output loss PF: [0.08446269 0.18152586 0.05683778 0.30451271 0.00365342 0.70253742
 0.03687532 0.41594326 0.2898128  0.0763225  0.33329231 0.43557662
 0.22727787 0.7017622  0.28783184 0.03911902 0.20232201 0.13651834
 0.08039176 0.09217729 0.17569122 0.18077031 0.10044205 0.12458986
 0.33666646 0.2310133  0.0154545  0.04969909 0.6845125 ]
2022-09-29 21:51:22,930 - INFO - Random guess loss PF: [0.39042157 0.09487171 0.12021794 0.38665187 0.34798852 0.33044046
 0.17144375 0.33212617 0.08739173 0.22932866 0.16606677 0.3999961
 0.29232734 0.33346295 0.20059723 0.35086828 0.28075892 0.29666603
 0.18670957 0.23062442 0.27392676 0.32166585 0.34478769 0.32489964
 0.16068426 0.29188311 0.33841693 0.34636849 0.28881305]
2022-09-29 21:51:22,930 - INFO - Attack result, first 2 samples: tensor([[0.2582, 0.0224, 0.9564, 0.8953, 0.1315, 0.9928, 0.2505, 0.8514, 0.9918,
         0.4536, 0.8827, 0.9247, 0.0036, 0.9859, 0.6331, 0.0214, 0.3957, 0.6063,
         0.9667, 0.2987, 0.0834, 0.0160, 0.2151, 0.0977, 0.9816, 0.0631, 0.0919,
         0.0765, 0.0684],
        [0.1506, 0.0083, 0.9137, 0.8915, 0.0488, 0.9907, 0.0786, 0.7202, 0.9873,
         0.3052, 0.8064, 0.6749, 0.0044, 0.9887, 0.6069, 0.0186, 0.3269, 0.7908,
         0.9670, 0.4341, 0.0097, 0.0225, 0.1788, 0.1836, 0.9846, 0.1651, 0.0915,
         0.1801, 0.0321]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:51:22,937 - INFO - Ground truth, first 2 samples: tensor([[3.0228e-03, 4.2362e-01, 7.5025e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         3.0592e-01, 6.5798e-02, 4.8574e-01, 0.0000e+00, 3.1359e-01, 0.0000e+00,
         0.0000e+00, 3.6056e-02, 3.6207e-02, 0.0000e+00, 9.3454e-01, 8.1869e-01,
         1.0000e+00, 5.0000e-02, 3.6253e-02, 1.0000e+00, 0.0000e+00, 0.0000e+00,
         5.0000e-01, 0.0000e+00, 3.2017e-03, 0.0000e+00, 8.7500e-01],
        [3.6863e-03, 3.6884e-01, 7.0597e-01, 0.0000e+00, 9.5969e-04, 0.0000e+00,
         2.4530e-01, 7.4999e-02, 4.3616e-01, 5.0000e-02, 4.9323e-01, 0.0000e+00,
         1.0000e-01, 2.3989e-02, 2.4041e-02, 0.0000e+00, 9.8278e-01, 1.0000e+00,
         1.0000e+00, 3.3333e-02, 2.4162e-02, 0.0000e+00, 0.0000e+00, 0.0000e+00,
         2.0000e-01, 0.0000e+00, 0.0000e+00, 1.0989e-02, 9.5000e-01]],
       device='cuda:0'):
2022-09-29 21:51:24,236 - CRITICAL - ------------------ SUMMARY ------------------
2022-09-29 21:51:24,236 - CRITICAL - Mean generator loss: 0.22259985763699777
2022-09-29 21:51:24,237 - CRITICAL - Mean random guess loss: 0.2604997394786727
2022-09-29 21:51:24,238 - CRITICAL - Mean generator loss Per Feature: [0.11477531 0.19168745 0.04817967 0.32374028 0.00513172 0.77173839
 0.04743185 0.40615324 0.2814538  0.08535364 0.27987979 0.41928807
 0.1800313  0.65756752 0.29512824 0.06626795 0.21834311 0.10715787
 0.08873426 0.09272277 0.13164291 0.13710959 0.11150485 0.14288256
 0.32037013 0.18880821 0.02106956 0.05029447 0.67094737]
2022-09-29 21:51:24,240 - CRITICAL - Mean random guess loss Per Feature: [0.33337964 0.10029954 0.15587631 0.33585921 0.33490406 0.33321966
 0.1547653  0.25884294 0.09317673 0.24678061 0.14723376 0.33118178
 0.23744961 0.25252562 0.24088022 0.33506978 0.25119198 0.30114637
 0.20901196 0.24842751 0.24558564 0.34094991 0.33622544 0.33208256
 0.17000236 0.33266558 0.32796912 0.32190622 0.24588302]
2022-09-29 21:51:24,240 - CRITICAL - Accuracy: tensor(0., device='cuda:0')
2022-09-29 21:51:24,242 - CRITICAL - Accur: tensor(0., device='cuda:0')
2022-09-29 21:51:24,243 - CRITICAL - Accur: 7930.0
2022-09-29 21:51:24,243 - CRITICAL - 2m 11s (- 2m 11s) (50%)
2022-09-29 21:51:24,243 - CRITICAL - 

<----------------- Running count: 2 / 2 ----------------->


2022-09-29 21:51:26,590 - CRITICAL - Dataset column permutation is: 
 tensor([49, 47, 53, 43, 39, 42, 27, 16, 40,  7, 48, 18, 21, 58, 54, 26, 37, 20,
        23, 35, 29, 15, 32,  1, 33, 44, 36,  0, 22, 38, 17,  3, 30, 45,  6,  4,
        25, 34, 24, 46, 56, 51, 41,  2, 52,  5, 12,  9, 57, 13,  8, 28, 14, 11,
        50, 19, 10, 31, 55])
2022-09-29 21:51:26,600 - CRITICAL - Creating dataset, len(samples): 39644; positive labels sum: 34720
2022-09-29 21:51:26,613 - CRITICAL - For dataset C:\Haider\Research\InferenceAttacksDefenses\featureinference-vfl\datasets\news_cleaned.csv, dataset length: 39644
2022-09-29 21:51:26,614 - CRITICAL - 
[FUNCTION]: Splitting dataset by getSplittedDataset()......
2022-09-29 21:51:26,614 - INFO - Display first (x, y) pair of dataset:
 tensor([3.7864e-01, 7.6923e-01, 4.0000e-01, 5.2162e-01, 4.0853e-01, 4.3273e-02,
        5.8817e-04, 0.0000e+00, 4.3483e-02, 1.7241e-02, 2.3077e-01, 2.6455e-03,
        0.0000e+00, 1.8750e-01, 8.0000e-01, 0.0000e+00, 0.0000e+00, 2.3349e-05,
        0.0000e+00, 0.0000e+00, 5.8817e-04, 0.0000e+00, 0.0000e+00, 4.7619e-01,
        0.0000e+00, 4.3359e-01, 0.0000e+00, 1.0000e+00, 0.0000e+00, 5.3973e-01,
        0.0000e+00, 9.4664e-04, 1.0000e+00, 2.9367e-01, 1.3158e-02, 9.5969e-04,
        0.0000e+00, 0.0000e+00, 2.7670e-04, 7.4074e-02, 4.0625e-01, 7.0000e-01,
        4.4534e-02, 2.5844e-02, 6.5000e-01, 1.2544e-03, 0.0000e+00, 0.0000e+00,
        0.0000e+00, 1.0000e+00, 7.8125e-03, 5.8817e-04, 0.0000e+00, 4.4444e-01,
        1.0000e-01, 0.0000e+00, 5.8202e-01, 0.0000e+00, 5.0000e-01]), tensor(0.)
2022-09-29 21:51:26,615 - INFO - Shape of (x, y): torch.Size([59]) torch.Size([])
2022-09-29 21:51:26,616 - CRITICAL - len(trainset): 23786
2022-09-29 21:51:26,616 - CRITICAL - len(testset): 7928
2022-09-29 21:51:26,616 - CRITICAL - len(predictset): 7930
2022-09-29 21:51:26,621 - INFO - len(trainloader): 372
2022-09-29 21:51:26,621 - INFO - len(testloader): 124
2022-09-29 21:51:26,621 - INFO - len(predictloader): 124
2022-09-29 21:51:26,621 - CRITICAL - 
[FUNCTION]: Creating GlobalClassifierTrainer......
2022-09-29 21:51:26,623 - CRITICAL - Creating a model for type NN
2022-09-29 21:51:26,628 - INFO - Structure of Global Classifier: GlobalPreModel_NN(
  (dense): Sequential(
    (0): Linear(in_features=59, out_features=600, bias=True)
    (1): ReLU()
    (2): Linear(in_features=600, out_features=300, bias=True)
    (3): ReLU()
    (4): Linear(in_features=300, out_features=100, bias=True)
    (5): ReLU()
    (6): Linear(in_features=100, out_features=5, bias=True)
  )
)
2022-09-29 21:51:26,629 - CRITICAL - 
[FUNCTION]: Creating GeneratorTrainer......
2022-09-29 21:51:26,629 - CRITICAL - Creating a generator
2022-09-29 21:51:26,633 - INFO - Structure of Generator: Generator(
  (net): Sequential(
    (0): Linear(in_features=59, out_features=600, bias=True)
    (1): LayerNorm((600,), eps=1e-05, elementwise_affine=True)
    (2): ReLU()
    (3): Linear(in_features=600, out_features=200, bias=True)
    (4): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
    (5): ReLU()
    (6): Linear(in_features=200, out_features=100, bias=True)
    (7): LayerNorm((100,), eps=1e-05, elementwise_affine=True)
    (8): ReLU()
    (9): Linear(in_features=100, out_features=29, bias=True)
    (10): Sigmoid()
  )
)
2022-09-29 21:51:26,633 - CRITICAL - 
[FUNCTION]: Training global classifier NN......
2022-09-29 21:51:27,854 - CRITICAL - In epoch 0, train accur is 0.4204574227333069, test accur is 0.42633703351020813.
2022-09-29 21:51:39,219 - CRITICAL - In epoch 12, train accur is 0.4606911838054657, test accur is 0.42658931016921997.
2022-09-29 21:51:50,733 - CRITICAL - In epoch 24, train accur is 0.5575128197669983, test accur is 0.39619070291519165.
2022-09-29 21:52:02,156 - CRITICAL - In epoch 36, train accur is 0.7304717302322388, test accur is 0.36238646507263184.
2022-09-29 21:52:13,691 - CRITICAL - In epoch 48, train accur is 0.8498276472091675, test accur is 0.33816850185394287.
2022-09-29 21:52:24,251 - CRITICAL - In epoch 59, train accur is 0.910577654838562, test accur is 0.33123108744621277.
2022-09-29 21:52:24,252 - CRITICAL - 
[FUNCTION]: Training Generator......
2022-09-29 21:52:24,254 - CRITICAL - Enable Attacker Features
2022-09-29 21:52:24,254 - CRITICAL - Disable Mean Constraint
2022-09-29 21:52:24,254 - CRITICAL - parameters['unknownVarLambda'] = 0.25
2022-09-29 21:52:24,254 - CRITICAL - Disable Confidence Rounding
2022-09-29 21:52:24,254 - CRITICAL - parameters['roundPrecision'] = 1
2022-09-29 21:52:25,439 - INFO - >>>>>>>>>>>>>>>>>
2022-09-29 21:52:25,440 - CRITICAL - In epoch 0, loss is tensor(68900.4688, device='cuda:0')
2022-09-29 21:52:25,441 - INFO - L2 norm of yhat: tensor(397.3535, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-29 21:52:25,442 - INFO - L2 norm of original vector: tensor(274.3934, device='cuda:0')
2022-09-29 21:52:25,443 - INFO - First two lines of yhat: tensor([[0.4152, 0.3137, 0.4532, 0.2908, 0.1329, 0.4270, 0.1566, 0.4188, 0.7193,
         0.2406, 0.7682, 0.7236, 0.7108, 0.4780, 0.5284, 0.4006, 0.3834, 0.1550,
         0.6113, 0.6390, 0.2224, 0.1053, 0.4083, 0.7817, 0.4419, 0.3243, 0.7531,
         0.5739, 0.4697],
        [0.4199, 0.3518, 0.4399, 0.3168, 0.1271, 0.4089, 0.1689, 0.4270, 0.7113,
         0.2785, 0.7455, 0.7176, 0.7026, 0.4848, 0.5719, 0.4748, 0.4102, 0.1320,
         0.6104, 0.6454, 0.1972, 0.1203, 0.3658, 0.7645, 0.4375, 0.3129, 0.7361,
         0.5301, 0.4804]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:52:25,447 - CRITICAL - Accuracy of the original model: tensor(0.0869, device='cuda:0')
2022-09-29 21:52:39,746 - INFO - >>>>>>>>>>>>>>>>>
2022-09-29 21:52:39,748 - CRITICAL - In epoch 12, loss is tensor(24939.5781, device='cuda:0')
2022-09-29 21:52:39,750 - INFO - L2 norm of yhat: tensor(549.2188, device='cuda:0', grad_fn=<SumBackward0>)
2022-09-29 21:52:39,751 - INFO - L2 norm of original vector: tensor(281.8197, device='cuda:0')
2022-09-29 21:52:39,752 - INFO - First two lines of yhat: tensor([[0.7419, 0.2962, 0.5538, 0.5460, 0.0939, 0.3336, 0.0767, 0.5562, 0.6733,
         0.1204, 0.9337, 0.9058, 0.4800, 0.7235, 0.9525, 0.4097, 0.1718, 0.0375,
         0.8264, 0.4335, 0.1684, 0.0208, 0.1691, 0.7897, 0.4024, 0.2255, 0.8661,
         0.7298, 0.5486],
        [0.7434, 0.3760, 0.5697, 0.4883, 0.1008, 0.4072, 0.0676, 0.5650, 0.6997,
         0.1199, 0.9451, 0.9099, 0.4506, 0.7631, 0.9414, 0.4904, 0.2165, 0.0295,
         0.8358, 0.4993, 0.1835, 0.0169, 0.1336, 0.7268, 0.4875, 0.3509, 0.8561,
         0.7849, 0.5050]], device='cuda:0', grad_fn=<SliceBackward0>)
2022-09-29 21:52:39,757 - CRITICAL - Accuracy of the original model: tensor(0.0855, device='cuda:0')
